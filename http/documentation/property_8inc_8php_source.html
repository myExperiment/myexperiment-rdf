<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>MyExperiment RDF: inc/functions/property.inc.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">MyExperiment RDF&#160;<span id="projectnumber">beta</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>inc/functions/property.inc.php</h1>  </div>
</div>
<div class="contents">
<a href="property_8inc_8php.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00025"></a><a class="code" href="property_8inc_8php.html#a5111c785fc992ce2d62ec8213ac3112b">00025</a> function <a class="code" href="property_8inc_8php.html#a5111c785fc992ce2d62ec8213ac3112b" title="Determine the URI for an entity from its type, ID and other fields retrieved from a database query...">getEntityURI</a>($type,$id,<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>){
<a name="l00026"></a>00026         global <a class="code" href="defaultsettings_8inc_8php.html#af3977e6112188cd0722cdde838f04c9d" title="A string specifying the base URI for any myExperiment RDF entities that are generated. (E.g. http://www.myexperiment.org/).">$datauri</a>, <a class="code" href="data_8inc_8php.html#ab536a0d95f590a75a3a4e3228224e5eb" title="A multi-dimensional associative array specifying all the myExperiment entity types a particular piece...">$entities</a>, <a class="code" href="data_8inc_8php.html#a77de31c759b8ff4ccaa90c0d27bf9d25" title="An associative array mapping entity types in the database to myExperiment entity types (as defined wi...">$db_entity_mappings</a>;
<a name="l00027"></a>00027         <span class="keywordflow">if</span> (empty($type) || empty($id)) {
<a name="l00028"></a>00028                 <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
<a name="l00029"></a>00029         }
<a name="l00030"></a>00030         $entity_type = $entities[$type];
<a name="l00031"></a>00031         $url_subpath = $entity_type[<span class="stringliteral">&#39;url_subpath&#39;</span>];
<a name="l00032"></a>00032         <span class="keywordflow">if</span> (isset($entity_type[<span class="stringliteral">&#39;nested_on&#39;</span>])){
<a name="l00033"></a>00033                 <span class="keywordflow">switch</span> ($type){
<a name="l00034"></a>00034                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;Attribution&#39;</span>:
<a name="l00035"></a>00035                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;Comment&#39;</span>:
<a name="l00036"></a>00036                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;Creditation&#39;</span>:
<a name="l00037"></a>00037                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;Rating&#39;</span>:
<a name="l00038"></a>00038                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;Review&#39;</span>:
<a name="l00039"></a>00039                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;Policy&#39;</span>:
<a name="l00040"></a>00040                                 $nesting_entity = $db_entity_mappings[<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[$entity_type[<span class="stringliteral">&#39;nested_on&#39;</span>][0]]];
<a name="l00041"></a>00041                                 <span class="keywordflow">return</span> $datauri . $entities[$nesting_entity][<span class="stringliteral">&#39;url_subpath&#39;</span>] . <span class="stringliteral">&quot;/&quot;</span>. <a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[$entity_type[<span class="stringliteral">&#39;nested_on&#39;</span>][1]] . <span class="stringliteral">&quot;/$url_subpath/$id&quot;</span>;
<a name="l00042"></a>00042                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;Citation&#39;</span>: 
<a name="l00043"></a>00043                                 <span class="keywordflow">return</span> $datauri.<span class="stringliteral">&quot;workflows/&quot;</span>.<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[$entity_type[<span class="stringliteral">&#39;nested_on&#39;</span>][0]].<span class="stringliteral">&quot;/versions/&quot;</span>.<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[$entity_type[<span class="stringliteral">&#39;nested_on&#39;</span>][1]].<span class="stringliteral">&quot;/$url_subpath/$id&quot;</span>;
<a name="l00044"></a>00044                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;GroupAnnouncement&#39;</span>:
<a name="l00045"></a>00045                                 <span class="keywordflow">return</span> $datauri . <span class="stringliteral">&quot;groups/&quot;</span> . <a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[$entity_type[<span class="stringliteral">&#39;nested_on&#39;</span>][1]] . <span class="stringliteral">&quot;/announcements/$id&quot;</span>;
<a name="l00046"></a>00046                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;Favourite&#39;</span>:
<a name="l00047"></a>00047                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;Friendship&#39;</span>:
<a name="l00048"></a>00048                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;Membership&#39;</span>:
<a name="l00049"></a>00049                                 <span class="keywordflow">return</span> $datauri.<span class="stringliteral">&quot;users/&quot;</span>.<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[$entity_type[<span class="stringliteral">&#39;nested_on&#39;</span>][0]].<span class="stringliteral">&quot;/$url_subpath/$id&quot;</span>;
<a name="l00050"></a>00050                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;Job&#39;</span>:
<a name="l00051"></a>00051                                 <span class="keywordflow">return</span> $datauri.<span class="stringliteral">&quot;experiments/&quot;</span>.<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[$entity_type[<span class="stringliteral">&#39;nested_on&#39;</span>][0]].<span class="stringliteral">&quot;/$url_subpath/$id&quot;</span>;
<a name="l00052"></a>00052                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;LocalPackEntry&#39;</span>:
<a name="l00053"></a>00053                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;RemotePackEntry&#39;</span>:
<a name="l00054"></a>00054                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;RelationshipEntry&#39;</span>:
<a name="l00055"></a>00055                                 <span class="keywordflow">return</span> $datauri.<span class="stringliteral">&quot;packs/&quot;</span>.<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[$entity_type[<span class="stringliteral">&#39;nested_on&#39;</span>][0]].<span class="stringliteral">&quot;/$url_subpath/$id&quot;</span>;
<a name="l00056"></a>00056                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;Tagging&#39;</span>:
<a name="l00057"></a>00057                                 <span class="keywordflow">return</span> $datauri.<span class="stringliteral">&quot;tags/&quot;</span>.<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[$entity_type[<span class="stringliteral">&#39;nested_on&#39;</span>][0]].<span class="stringliteral">&quot;/$url_subpath/$id&quot;</span>;
<a name="l00058"></a>00058                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;Ontology&#39;</span>:
<a name="l00059"></a>00059                                 <span class="keywordflow">return</span> <a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[<span class="stringliteral">&#39;uri&#39;</span>];
<a name="l00060"></a>00060                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;ObjectProperty&#39;</span>:
<a name="l00061"></a>00061                                 <span class="keywordflow">return</span> <a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[<span class="stringliteral">&#39;ontology_uri&#39;</span>].<span class="stringliteral">&quot;/&quot;</span>.<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[<span class="stringliteral">&#39;title&#39;</span>];
<a name="l00062"></a>00062                         <span class="keywordflow">default</span>:
<a name="l00063"></a>00063                                 <span class="keywordflow">break</span>;
<a name="l00064"></a>00064                 }
<a name="l00065"></a>00065         }
<a name="l00066"></a>00066         elseif (isset(<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[<span class="stringliteral">&#39;contributable_version&#39;</span>])) {
<a name="l00067"></a>00067                 <span class="keywordflow">return</span> <span class="stringliteral">&quot;{$datauri}{$url_subpath}/{$id}/versions/{$entity[&#39;contributable_version&#39;]}&quot;</span>;
<a name="l00068"></a>00068         }
<a name="l00069"></a>00069         elseif (isset($entity_type[<span class="stringliteral">&#39;parent_id&#39;</span>])) {
<a name="l00070"></a>00070                 $version_sql = <span class="stringliteral">&quot;SELECT {$entity_type[&#39;parent_id&#39;]} AS parent_id, version FROM {$entity_type[&#39;table&#39;]} WHERE id = $id&quot;</span>;
<a name="l00071"></a>00071                 $version_res = mysqli_query($con, $version_sql);
<a name="l00072"></a>00072                 <span class="keywordflow">if</span> (mysqli_num_rows($version_res) == 0) {
<a name="l00073"></a>00073                         <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
<a name="l00074"></a>00074                 }
<a name="l00075"></a>00075                 $version = mysqli_fetch_assoc($version_res);
<a name="l00076"></a>00076                 <span class="keywordflow">return</span> $datauri . $entities[$entity_type[<span class="stringliteral">&#39;parent_entity&#39;</span>]][<span class="stringliteral">&#39;url_subpath&#39;</span>] . <span class="stringliteral">&quot;/&quot;</span> . $version[<span class="stringliteral">&#39;parent_id&#39;</span>] . <span class="stringliteral">&quot;/versions/&quot;</span> . $version[<span class="stringliteral">&#39;version&#39;</span>];
<a name="l00077"></a>00077         }
<a name="l00078"></a>00078         elseif ($type==<span class="stringliteral">&quot;GroupAnnouncement&quot;</span>){
<a name="l00079"></a>00079                 $gasql=<span class="stringliteral">&quot;select network_id from group_announcements where id=$id&quot;</span>;
<a name="l00080"></a>00080                 $gares=mysqli_query($con, $gasql);
<a name="l00081"></a>00081                 <span class="keywordflow">return</span> $datauri.<span class="stringliteral">&quot;groups/&quot;</span>.mysqli_result($gares,0,<span class="stringliteral">&#39;network_id&#39;</span>).<span class="stringliteral">&quot;/announcements/&quot;</span>.$id;
<a name="l00082"></a>00082         }
<a name="l00083"></a>00083         elseif ($type==<span class="stringliteral">&quot;Ontology&quot;</span>) <span class="keywordflow">return</span> <a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[<span class="stringliteral">&#39;uri&#39;</span>];
<a name="l00084"></a>00084         <span class="keywordflow">return</span> $datauri.<span class="stringliteral">&quot;$url_subpath/$id&quot;</span>;
<a name="l00085"></a>00085 }
<a name="l00086"></a>00086 
<a name="l00096"></a><a class="code" href="property_8inc_8php.html#afd23379791339acba6539eabdc6f4609">00096</a> function <a class="code" href="property_8inc_8php.html#afd23379791339acba6539eabdc6f4609" title="Get the URI for either the User who requested to join a Group or the Group that requested a user join...">getRequester</a>($mship){
<a name="l00097"></a>00097         <span class="keywordflow">if</span> (empty($mship[<span class="stringliteral">&#39;user_established_at&#39;</span>])) <span class="keywordflow">return</span> <span class="stringliteral">&quot;groups/&quot;</span>.$mship[<span class="stringliteral">&#39;network_id&#39;</span>];
<a name="l00098"></a>00098         elseif(empty($mship[<span class="stringliteral">&#39;network_established_at&#39;</span>])) <span class="keywordflow">return</span> <span class="stringliteral">&quot;users/&quot;</span>.$mship[<span class="stringliteral">&#39;user_id&#39;</span>];
<a name="l00099"></a>00099         $utime=strtotime($mship[<span class="stringliteral">&#39;user_established_at&#39;</span>]);
<a name="l00100"></a>00100         $ntime=strtotime($mship[<span class="stringliteral">&#39;network_established_at&#39;</span>]);
<a name="l00101"></a>00101         <span class="keywordflow">if</span> ($utime&lt;=$ntime) <span class="keywordflow">return</span> <span class="stringliteral">&quot;users/&quot;</span>.$mship[<span class="stringliteral">&#39;user_id&#39;</span>];
<a name="l00102"></a>00102         <span class="keywordflow">return</span> <span class="stringliteral">&quot;groups/&quot;</span>.$mship[<span class="stringliteral">&#39;network_id&#39;</span>];
<a name="l00103"></a>00103 }
<a name="l00104"></a>00104 
<a name="l00114"></a><a class="code" href="property_8inc_8php.html#afc8db501e110b270892967fc5e7ad752">00114</a> function <a class="code" href="property_8inc_8php.html#afc8db501e110b270892967fc5e7ad752" title="Get the datetime for when membership to a Group was requested.">getRequesterTime</a>($mship){
<a name="l00115"></a>00115         <span class="keywordflow">if</span> (!$mship[<span class="stringliteral">&#39;user_established_at&#39;</span>]) <span class="keywordflow">return</span> $mship[<span class="stringliteral">&#39;network_established_at&#39;</span>];
<a name="l00116"></a>00116         elseif(!$mship[<span class="stringliteral">&#39;network_established_at&#39;</span>]) <span class="keywordflow">return</span> $mship[<span class="stringliteral">&#39;user_established_at&#39;</span>];
<a name="l00117"></a>00117         $utime=strtotime($mship[<span class="stringliteral">&#39;user_established_at&#39;</span>]);
<a name="l00118"></a>00118         $ntime=strtotime($mship[<span class="stringliteral">&#39;network_established_at&#39;</span>]);
<a name="l00119"></a>00119         <span class="keywordflow">if</span> ($utime&lt;=$ntime) <span class="keywordflow">return</span> $mship[<span class="stringliteral">&#39;user_established_at&#39;</span>];
<a name="l00120"></a>00120         <span class="keywordflow">return</span> $mship[<span class="stringliteral">&#39;network_established_at&#39;</span>];
<a name="l00121"></a>00121 }
<a name="l00122"></a>00122 
<a name="l00132"></a><a class="code" href="property_8inc_8php.html#a9f5906a636ed8decf578ac657073c935">00132</a> function <a class="code" href="property_8inc_8php.html#a9f5906a636ed8decf578ac657073c935" title="Get the URI for either the User who accepted to join a Group or the Group that accepted a user join i...">getAccepter</a>($mship){
<a name="l00133"></a>00133         <span class="keywordflow">if</span> (empty($mship[<span class="stringliteral">&#39;user_established_at&#39;</span>])){
<a name="l00134"></a>00134                 <span class="keywordflow">if</span> (!empty($mship[<span class="stringliteral">&#39;user_id&#39;</span>])) <span class="keywordflow">return</span> <span class="stringliteral">&quot;users/&quot;</span>.$mship[<span class="stringliteral">&#39;user_id&#39;</span>];
<a name="l00135"></a>00135                 <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
<a name="l00136"></a>00136         }
<a name="l00137"></a>00137         elseif(empty($mship[<span class="stringliteral">&#39;network_established_at&#39;</span>])) <span class="keywordflow">return</span> <span class="stringliteral">&quot;groups/&quot;</span>.$mship[<span class="stringliteral">&#39;network_id&#39;</span>];
<a name="l00138"></a>00138         $utime=strtotime($mship[<span class="stringliteral">&#39;user_established_at&#39;</span>]);
<a name="l00139"></a>00139         $ntime=strtotime($mship[<span class="stringliteral">&#39;network_established_at&#39;</span>]);
<a name="l00140"></a>00140         <span class="keywordflow">if</span> ($utime&lt;=$ntime) <span class="keywordflow">return</span> <span class="stringliteral">&quot;groups/&quot;</span>.$mship[<span class="stringliteral">&#39;network_id&#39;</span>];
<a name="l00141"></a>00141         <span class="keywordflow">return</span> <span class="stringliteral">&quot;users/&quot;</span>.$mship[<span class="stringliteral">&#39;user_id&#39;</span>];      
<a name="l00142"></a>00142 }
<a name="l00143"></a>00143 
<a name="l00153"></a><a class="code" href="property_8inc_8php.html#aedbdb6b05bed1b74be9a1edcfded1d98">00153</a> function <a class="code" href="property_8inc_8php.html#aedbdb6b05bed1b74be9a1edcfded1d98" title="Get the datetime for when membership to a Group was accepted.">getAccepterTime</a>($mship){
<a name="l00154"></a>00154         <span class="keywordflow">if</span> ($mship[<span class="stringliteral">&#39;network_established_at&#39;</span>] &amp;&amp; $mship[<span class="stringliteral">&#39;user_established_at&#39;</span>]){
<a name="l00155"></a>00155                 $utime=strtotime($mship[<span class="stringliteral">&#39;user_established_at&#39;</span>]);
<a name="l00156"></a>00156                 $ntime=strtotime($mship[<span class="stringliteral">&#39;network_established_at&#39;</span>]);
<a name="l00157"></a>00157                 <span class="keywordflow">if</span> ($utime&gt;$ntime) <span class="keywordflow">return</span> $mship[<span class="stringliteral">&#39;user_established_at&#39;</span>];
<a name="l00158"></a>00158                 <span class="keywordflow">else</span> <span class="keywordflow">return</span> $mship[<span class="stringliteral">&#39;network_established_at&#39;</span>];
<a name="l00159"></a>00159         }
<a name="l00160"></a>00160         <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
<a name="l00161"></a>00161 }
<a name="l00162"></a>00162 
<a name="l00172"></a><a class="code" href="property_8inc_8php.html#a58c4b0e152cd23966f5d1de2136212b5">00172</a> function <a class="code" href="property_8inc_8php.html#a58c4b0e152cd23966f5d1de2136212b5" title="Generates a set of sioc:has_member RDF properties for all the members of a specified Group...">getMembers</a>($group){
<a name="l00173"></a>00173         global <a class="code" href="defaultsettings_8inc_8php.html#af3977e6112188cd0722cdde838f04c9d" title="A string specifying the base URI for any myExperiment RDF entities that are generated. (E.g. http://www.myexperiment.org/).">$datauri</a>;
<a name="l00174"></a>00174         <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00175"></a>00175         $msql = <span class="stringliteral">&quot;select * from memberships where network_id=$group[id] and network_established_at is not null and user_established_at is not null&quot;</span>;
<a name="l00176"></a>00176         $mres=mysqli_query($con, $msql);
<a name="l00177"></a>00177         <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>.=<span class="stringliteral">&quot;    &lt;sioc:has_member rdf:resource=\&quot;${datauri}users/&quot;</span>.$group[<span class="stringliteral">&#39;user_id&#39;</span>].<span class="stringliteral">&quot;\&quot;/&gt;\n&quot;</span>;
<a name="l00178"></a>00178         <span class="keywordflow">for</span> ($m=0; $m&lt;mysqli_num_rows($mres); $m++){
<a name="l00179"></a>00179                 <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>.=<span class="stringliteral">&quot;    &lt;sioc:has_member rdf:resource=\&quot;${datauri}users/&quot;</span>.mysqli_result($mres,$m,<span class="stringliteral">&#39;user_id&#39;</span>).<span class="stringliteral">&quot;\&quot;/&gt;\n&quot;</span>;
<a name="l00180"></a>00180         }
<a name="l00181"></a>00181         <span class="keywordflow">return</span> <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>;
<a name="l00182"></a>00182 }
<a name="l00183"></a>00183 
<a name="l00193"></a><a class="code" href="property_8inc_8php.html#aa2c9d98ca81aa5e21d3aa370a9cbb6d4">00193</a> function <a class="code" href="property_8inc_8php.html#aa2c9d98ca81aa5e21d3aa370a9cbb6d4" title="Generates a set of mebase:has-membership RDF properties for all the Memberships of a User...">getMemberships</a>($user){
<a name="l00194"></a>00194         global <a class="code" href="generateDataflowRDF_8php.html#a047170d6020a882807665812a27e2525" title="A string containing an SQL query to find all the publically downloadable workflows that have dataflow...">$sql</a>, <a class="code" href="defaultsettings_8inc_8php.html#af3977e6112188cd0722cdde838f04c9d" title="A string specifying the base URI for any myExperiment RDF entities that are generated. (E.g. http://www.myexperiment.org/).">$datauri</a>;
<a name="l00195"></a>00195         <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00196"></a>00196         <span class="keywordflow">if</span> (isset($user[<span class="stringliteral">&#39;id&#39;</span>])){
<a name="l00197"></a>00197                 $msql=$sql[<span class="stringliteral">&#39;Membership&#39;</span>].<span class="stringliteral">&quot; where user_id=$user[id]&quot;</span>;
<a name="l00198"></a>00198                 $mres=mysqli_query($con, $msql);
<a name="l00199"></a>00199                 <span class="keywordflow">for</span> ($m=0; $m&lt;mysqli_num_rows($mres); $m++){
<a name="l00200"></a>00200                         <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>.=<span class="stringliteral">&quot;    &lt;mebase:has-membership rdf:resource=\&quot;${datauri}users/$user[id]/memberships/&quot;</span>.mysqli_result($mres,$m,<span class="stringliteral">&#39;id&#39;</span>).<span class="stringliteral">&quot;\&quot;/&gt;\n&quot;</span>;
<a name="l00201"></a>00201                 }
<a name="l00202"></a>00202         }
<a name="l00203"></a>00203         <span class="keywordflow">return</span> <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>;
<a name="l00204"></a>00204 }
<a name="l00205"></a>00205 
<a name="l00215"></a><a class="code" href="property_8inc_8php.html#ae5a203f7cf24a42d642776e221d8e0ce">00215</a> function <a class="code" href="property_8inc_8php.html#ae5a203f7cf24a42d642776e221d8e0ce" title="Generates a set of mebase:has-friendship RDF properties for all the Friendships of a User...">getFriendships</a>($user){
<a name="l00216"></a>00216         global <a class="code" href="generateDataflowRDF_8php.html#a047170d6020a882807665812a27e2525" title="A string containing an SQL query to find all the publically downloadable workflows that have dataflow...">$sql</a>, <a class="code" href="defaultsettings_8inc_8php.html#af3977e6112188cd0722cdde838f04c9d" title="A string specifying the base URI for any myExperiment RDF entities that are generated. (E.g. http://www.myexperiment.org/).">$datauri</a>;
<a name="l00217"></a>00217         <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00218"></a>00218         <span class="keywordflow">if</span> (isset($user[<span class="stringliteral">&#39;id&#39;</span>])){
<a name="l00219"></a>00219                 $fsql=<a class="code" href="sql_8inc_8php.html#a23178aec7094ea4ec918b397d8a87605" title="Add the first or an additional sub-clause to the where clause of an SQL query.">addWhereClause</a>($sql[<span class="stringliteral">&#39;Friendship&#39;</span>],<span class="stringliteral">&quot;user_id=$user[id] or friend_id=$user[id]&quot;</span>);
<a name="l00220"></a>00220                 $fres=mysqli_query($con, $fsql);
<a name="l00221"></a>00221                 <span class="keywordflow">for</span> ($f=0; $f&lt;mysqli_num_rows($fres); $f++){
<a name="l00222"></a>00222                         <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>.=<span class="stringliteral">&quot;    &lt;mebase:has-friendship rdf:resource=\&quot;${datauri}users/&quot;</span>.mysqli_result($fres,$f,<span class="stringliteral">&#39;user_id&#39;</span>).<span class="stringliteral">&quot;/friendships/&quot;</span>.mysqli_result($fres,$f,<span class="stringliteral">&#39;id&#39;</span>).<span class="stringliteral">&quot;\&quot;/&gt;\n&quot;</span>;
<a name="l00223"></a>00223                 }
<a name="l00224"></a>00224         }
<a name="l00225"></a>00225         <span class="keywordflow">return</span> <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>;
<a name="l00226"></a>00226 }
<a name="l00227"></a>00227 
<a name="l00237"></a><a class="code" href="property_8inc_8php.html#ab59d0e4d0742588d1b491aaa68edc8cc">00237</a> function <a class="code" href="property_8inc_8php.html#ab59d0e4d0742588d1b491aaa68edc8cc" title="Generates a set of meannot:has-favourite RDF properties for all the Favourites of a User...">getFavourites</a>($user){
<a name="l00238"></a>00238         global <a class="code" href="generateDataflowRDF_8php.html#a047170d6020a882807665812a27e2525" title="A string containing an SQL query to find all the publically downloadable workflows that have dataflow...">$sql</a>, <a class="code" href="defaultsettings_8inc_8php.html#af3977e6112188cd0722cdde838f04c9d" title="A string specifying the base URI for any myExperiment RDF entities that are generated. (E.g. http://www.myexperiment.org/).">$datauri</a>;
<a name="l00239"></a>00239         <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00240"></a>00240         <span class="keywordflow">if</span> (isset($user[<span class="stringliteral">&#39;id&#39;</span>])){
<a name="l00241"></a>00241                 $fsql=<a class="code" href="sql_8inc_8php.html#a23178aec7094ea4ec918b397d8a87605" title="Add the first or an additional sub-clause to the where clause of an SQL query.">addWhereClause</a>($sql[<span class="stringliteral">&#39;Favourite&#39;</span>],<span class="stringliteral">&quot;user_id=$user[id]&quot;</span>);
<a name="l00242"></a>00242                 $fres=mysqli_query($con, $fsql);
<a name="l00243"></a>00243                 <span class="keywordflow">for</span> ($f=0; $f&lt;mysqli_num_rows($fres); $f++){
<a name="l00244"></a>00244                         <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>.=<span class="stringliteral">&quot;    &lt;meannot:has-favourite rdf:resource=\&quot;${datauri}users/$user[id]/favourites/&quot;</span>.mysqli_result($fres,$f,<span class="stringliteral">&#39;id&#39;</span>).<span class="stringliteral">&quot;\&quot;/&gt;\n&quot;</span>;
<a name="l00245"></a>00245                 }
<a name="l00246"></a>00246                 <span class="keywordflow">return</span> <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>;
<a name="l00247"></a>00247         }
<a name="l00248"></a>00248 }
<a name="l00249"></a>00249 
<a name="l00259"></a><a class="code" href="property_8inc_8php.html#a178de8455c8c368ad063f60a7aa475f0">00259</a> function <a class="code" href="property_8inc_8php.html#a178de8455c8c368ad063f60a7aa475f0" title="Generates a set of meannot:for-tagging RDF properties for all the Taggings (uses) of a Tag...">getTaggings</a>($tag){
<a name="l00260"></a>00260         global <a class="code" href="generateDataflowRDF_8php.html#a047170d6020a882807665812a27e2525" title="A string containing an SQL query to find all the publically downloadable workflows that have dataflow...">$sql</a>, <a class="code" href="defaultsettings_8inc_8php.html#af3977e6112188cd0722cdde838f04c9d" title="A string specifying the base URI for any myExperiment RDF entities that are generated. (E.g. http://www.myexperiment.org/).">$datauri</a>;
<a name="l00261"></a>00261         <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00262"></a>00262         $tsql=<a class="code" href="sql_8inc_8php.html#a23178aec7094ea4ec918b397d8a87605" title="Add the first or an additional sub-clause to the where clause of an SQL query.">addWhereClause</a>($sql[<span class="stringliteral">&#39;Tagging&#39;</span>],<span class="stringliteral">&quot;tag_id=$tag[id]&quot;</span>);
<a name="l00263"></a>00263         $tres=mysqli_query($con, $tsql);
<a name="l00264"></a>00264         <span class="keywordflow">for</span> ($t=0; $t&lt;mysqli_num_rows($tres); $t++){
<a name="l00265"></a>00265                 $row=mysqli_fetch_assoc($tres);
<a name="l00266"></a>00266                 <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>.=<span class="stringliteral">&quot;    &lt;meannot:for-tagging rdf:resource=\&quot;&quot;</span>.getEntityURI(<span class="stringliteral">&#39;Tagging&#39;</span>,$row[<span class="stringliteral">&#39;id&#39;</span>],$row).<span class="stringliteral">&quot;\&quot;/&gt;\n&quot;</span>;
<a name="l00267"></a>00267         }
<a name="l00268"></a>00268         <span class="keywordflow">return</span> <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>;
<a name="l00269"></a>00269 }
<a name="l00270"></a>00270 
<a name="l00283"></a><a class="code" href="property_8inc_8php.html#a9648f9bd3571b95b828cb2b556e6ba10">00283</a> function <a class="code" href="property_8inc_8php.html#a9648f9bd3571b95b828cb2b556e6ba10" title="Get the URI for the Policy of an entity of a specified type.">getPolicyURI</a>($contrib, $type){
<a name="l00284"></a>00284         global <a class="code" href="data_8inc_8php.html#ab536a0d95f590a75a3a4e3228224e5eb" title="A multi-dimensional associative array specifying all the myExperiment entity types a particular piece...">$entities</a>;
<a name="l00285"></a>00285         <span class="keywordflow">if</span> (isset($entities[$type][<span class="stringliteral">&#39;parent_entity&#39;</span>])){
<a name="l00286"></a>00286                 $policy[<span class="stringliteral">&#39;contributable_type&#39;</span>]=$entities[$entities[$type][<span class="stringliteral">&#39;parent_entity&#39;</span>]][<span class="stringliteral">&#39;db_entity&#39;</span>];
<a name="l00287"></a>00287                 $policy[<span class="stringliteral">&#39;contributable_id&#39;</span>]=$contrib[$entities[$type][<span class="stringliteral">&#39;parent_id&#39;</span>]];
<a name="l00288"></a>00288         }
<a name="l00289"></a>00289         <span class="keywordflow">else</span>{
<a name="l00290"></a>00290                 $policy[<span class="stringliteral">&#39;contributable_type&#39;</span>]=$entities[$type][<span class="stringliteral">&#39;db_entity&#39;</span>];
<a name="l00291"></a>00291                 $policy[<span class="stringliteral">&#39;contributable_id&#39;</span>]=$contrib[<span class="stringliteral">&#39;id&#39;</span>];
<a name="l00292"></a>00292         }
<a name="l00293"></a>00293         
<a name="l00294"></a>00294         <span class="keywordflow">return</span> <a class="code" href="property_8inc_8php.html#a5111c785fc992ce2d62ec8213ac3112b" title="Determine the URI for an entity from its type, ID and other fields retrieved from a database query...">getEntityURI</a>(<span class="stringliteral">&#39;Policy&#39;</span>,$contrib[<span class="stringliteral">&#39;policy_id&#39;</span>],$policy);
<a name="l00295"></a>00295 }
<a name="l00296"></a>00296 
<a name="l00306"></a><a class="code" href="property_8inc_8php.html#a16b81b0e06f6744f95155e15e3f8d900">00306</a> function <a class="code" href="property_8inc_8php.html#a16b81b0e06f6744f95155e15e3f8d900" title="Get the thumbnail preview URL for a Workflow or WorkflowVersion.">getThumbnail</a>($workflow){
<a name="l00307"></a>00307         $url=<a class="code" href="property_8inc_8php.html#a7b8d24c0b1c79c96c9d768561479572a" title="Get a specified type of preview URL for a Workflow or WorkflowVersion.">getPreviewURL</a>($workflow,<span class="stringliteral">&#39;thumb&#39;</span>);
<a name="l00308"></a>00308         <span class="keywordflow">return</span> $url;
<a name="l00309"></a>00309 }
<a name="l00310"></a>00310 
<a name="l00320"></a><a class="code" href="property_8inc_8php.html#a3019f259e2bac1ace05563d0855c39e9">00320</a> function <a class="code" href="property_8inc_8php.html#a3019f259e2bac1ace05563d0855c39e9" title="Get the big thumbnail preview URL for a Workflow or WorkflowVersion.">getThumbnailBig</a>($workflow){
<a name="l00321"></a>00321         $url=<a class="code" href="property_8inc_8php.html#a7b8d24c0b1c79c96c9d768561479572a" title="Get a specified type of preview URL for a Workflow or WorkflowVersion.">getPreviewURL</a>($workflow,<span class="stringliteral">&#39;medium&#39;</span>);
<a name="l00322"></a>00322         <span class="keywordflow">return</span> $url;
<a name="l00323"></a>00323 }
<a name="l00324"></a>00324 
<a name="l00334"></a><a class="code" href="property_8inc_8php.html#a6e6caf1b860e083b5ae7204154037f30">00334</a> function <a class="code" href="property_8inc_8php.html#a6e6caf1b860e083b5ae7204154037f30" title="Get the full preview URL for a Workflow or WorkflowVersion.">getPreview</a>($workflow){
<a name="l00335"></a>00335         $url=<a class="code" href="property_8inc_8php.html#a7b8d24c0b1c79c96c9d768561479572a" title="Get a specified type of preview URL for a Workflow or WorkflowVersion.">getPreviewURL</a>($workflow,<span class="stringliteral">&#39;full&#39;</span>);
<a name="l00336"></a>00336         <span class="keywordflow">return</span> $url;
<a name="l00337"></a>00337 }
<a name="l00338"></a>00338 
<a name="l00348"></a><a class="code" href="property_8inc_8php.html#a1a9114659c7562037444e165fb3ea280">00348</a> function <a class="code" href="property_8inc_8php.html#a1a9114659c7562037444e165fb3ea280" title="Get the SVG preview URL for a Workflow or WorkflowVersion.">getSVG</a>($workflow){     
<a name="l00349"></a>00349         $url=<a class="code" href="property_8inc_8php.html#a7b8d24c0b1c79c96c9d768561479572a" title="Get a specified type of preview URL for a Workflow or WorkflowVersion.">getPreviewURL</a>($workflow,<span class="stringliteral">&#39;svg&#39;</span>);
<a name="l00350"></a>00350         <span class="keywordflow">return</span> $url;
<a name="l00351"></a>00351 }
<a name="l00352"></a>00352 
<a name="l00365"></a><a class="code" href="property_8inc_8php.html#a7b8d24c0b1c79c96c9d768561479572a">00365</a> function <a class="code" href="property_8inc_8php.html#a7b8d24c0b1c79c96c9d768561479572a" title="Get a specified type of preview URL for a Workflow or WorkflowVersion.">getPreviewURL</a>($workflow,$type=<span class="stringliteral">&quot;&quot;</span>){
<a name="l00366"></a>00366         global <a class="code" href="defaultsettings_8inc_8php.html#af3977e6112188cd0722cdde838f04c9d" title="A string specifying the base URI for any myExperiment RDF entities that are generated. (E.g. http://www.myexperiment.org/).">$datauri</a>;
<a name="l00367"></a>00367         <span class="keywordflow">if</span> (isset($workflow[<span class="stringliteral">&#39;workflow_id&#39;</span>])){
<a name="l00368"></a>00368                 <span class="keywordflow">return</span> $datauri.<span class="stringliteral">&quot;workflows/&quot;</span>.$workflow[<span class="stringliteral">&#39;workflow_id&#39;</span>].<span class="stringliteral">&quot;/versions/&quot;</span>.$workflow[<span class="stringliteral">&#39;version&#39;</span>].<span class="stringliteral">&quot;/previews/&quot;</span>.$type;
<a name="l00369"></a>00369         }
<a name="l00370"></a>00370         <span class="keywordflow">return</span> $datauri.<span class="stringliteral">&quot;workflows/&quot;</span>.$workflow[<span class="stringliteral">&#39;id&#39;</span>].<span class="stringliteral">&quot;/previews/&quot;</span>.$type;
<a name="l00371"></a>00371 }
<a name="l00372"></a>00372 
<a name="l00385"></a><a class="code" href="property_8inc_8php.html#a779a54fe8f78b5fb53a709d6629f6756">00385</a> function <a class="code" href="property_8inc_8php.html#a779a54fe8f78b5fb53a709d6629f6756" title="Get the download URL for an entity that has a downloadable item. (E.g. File, FileVersion, Workflow or WorkflowVersion).">getDownloadURL</a>(<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>, $type) {
<a name="l00386"></a>00386         <span class="keywordflow">switch</span> ($type) {
<a name="l00387"></a>00387                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;File&#39;</span>:
<a name="l00388"></a>00388                         <span class="keywordflow">return</span> <a class="code" href="property_8inc_8php.html#a5111c785fc992ce2d62ec8213ac3112b" title="Determine the URI for an entity from its type, ID and other fields retrieved from a database query...">getEntityURI</a>($type, <a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[<span class="stringliteral">&#39;id&#39;</span>], <a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>).<span class="stringliteral">&quot;/download/&quot;</span>.urlencode(<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[<span class="stringliteral">&#39;local_name&#39;</span>]);
<a name="l00389"></a>00389                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;FileVersion&#39;</span>:
<a name="l00390"></a>00390                         <span class="keywordflow">return</span> <a class="code" href="property_8inc_8php.html#a5111c785fc992ce2d62ec8213ac3112b" title="Determine the URI for an entity from its type, ID and other fields retrieved from a database query...">getEntityURI</a>($type, <a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[<span class="stringliteral">&#39;id&#39;</span>], <a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>).<span class="stringliteral">&quot;/download/&quot;</span>.urlencode(<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[<span class="stringliteral">&#39;local_name&#39;</span>]);
<a name="l00391"></a>00391                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;Workflow&#39;</span>: 
<a name="l00392"></a>00392                         <span class="keywordflow">return</span> <a class="code" href="property_8inc_8php.html#a5111c785fc992ce2d62ec8213ac3112b" title="Determine the URI for an entity from its type, ID and other fields retrieved from a database query...">getEntityURI</a>($type, <a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[<span class="stringliteral">&#39;id&#39;</span>], <a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>).<span class="stringliteral">&quot;/download/&quot;</span>.urlencode(<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[<span class="stringliteral">&#39;unique_name&#39;</span>]).<span class="stringliteral">&quot;.&quot;</span>.<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[<span class="stringliteral">&#39;file_ext&#39;</span>];
<a name="l00393"></a>00393                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;WorkflowVersion&#39;</span>:
<a name="l00394"></a>00394                         <span class="keywordflow">return</span> <a class="code" href="property_8inc_8php.html#a5111c785fc992ce2d62ec8213ac3112b" title="Determine the URI for an entity from its type, ID and other fields retrieved from a database query...">getEntityURI</a>(<span class="stringliteral">&quot;Workflow&quot;</span>, <a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[<span class="stringliteral">&#39;workflow_id&#39;</span>], <a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>).<span class="stringliteral">&quot;/download/&quot;</span>.urlencode(<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[<span class="stringliteral">&#39;unique_name&#39;</span>]).<span class="stringliteral">&quot;.&quot;</span>.<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[<span class="stringliteral">&#39;file_ext&#39;</span>].<span class="stringliteral">&quot;?version=&quot;</span>.<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[<span class="stringliteral">&#39;version&#39;</span>]; 
<a name="l00395"></a>00395         }
<a name="l00396"></a>00396         <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
<a name="l00397"></a>00397 }
<a name="l00398"></a>00398 
<a name="l00411"></a><a class="code" href="property_8inc_8php.html#a2abc5a29d35711eb1de3ae83a48ff0ef">00411</a> function <a class="code" href="property_8inc_8php.html#a2abc5a29d35711eb1de3ae83a48ff0ef" title="Get the URI for the current/latest version of a versioned entity (e.g. Workflow, File or Pack)...">getCurrentVersion</a>(<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>, $type) {
<a name="l00412"></a>00412         global <a class="code" href="defaultsettings_8inc_8php.html#af3977e6112188cd0722cdde838f04c9d" title="A string specifying the base URI for any myExperiment RDF entities that are generated. (E.g. http://www.myexperiment.org/).">$datauri</a>, <a class="code" href="data_8inc_8php.html#ab536a0d95f590a75a3a4e3228224e5eb" title="A multi-dimensional associative array specifying all the myExperiment entity types a particular piece...">$entities</a>;
<a name="l00413"></a>00413         <span class="keywordflow">if</span> (empty($entities[$type][<span class="stringliteral">&#39;version_entity&#39;</span>]) || empty(<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[<span class="stringliteral">&#39;current_version&#39;</span>])) <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
<a name="l00414"></a>00414         <span class="keywordflow">return</span> <span class="stringliteral">&quot;$datauri{$entities[$type][&#39;url_subpath&#39;]}/{$entity[&#39;id&#39;]}/versions/{$entity[&#39;current_version&#39;]}&quot;</span>;
<a name="l00415"></a>00415 }
<a name="l00416"></a>00416 
<a name="l00426"></a><a class="code" href="property_8inc_8php.html#a918cf27e11d53731072363f1c8543e7e">00426</a> function <a class="code" href="property_8inc_8php.html#a918cf27e11d53731072363f1c8543e7e" title="Test whether the specified version is the current/latest version of a particular versioned entity (e...">getIsCurrentVersion</a>($version){
<a name="l00427"></a>00427         global <a class="code" href="data_8inc_8php.html#ab536a0d95f590a75a3a4e3228224e5eb" title="A multi-dimensional associative array specifying all the myExperiment entity types a particular piece...">$entities</a>;
<a name="l00428"></a>00428         <span class="keywordflow">foreach</span> ($entities as $type =&gt; <a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>) {
<a name="l00429"></a>00429                 <span class="keywordflow">if</span> (!empty(<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[<span class="stringliteral">&#39;versioned_id&#39;</span>]) &amp;&amp; !empty($version[<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[<span class="stringliteral">&#39;versioned_id&#39;</span>]])) {
<a name="l00430"></a>00430                         $db_version_table = $entity[<span class="stringliteral">&#39;table&#39;</span>];
<a name="l00431"></a>00431                         $db_table = $entities[$entity[<span class="stringliteral">&#39;versioned_entity&#39;</span>]][<span class="stringliteral">&#39;table&#39;</span>];
<a name="l00432"></a>00432                         $version_sql = <span class="stringliteral">&quot;SELECT {$db_table}.id FROM {$db_table} INNER JOIN {$db_version_table} ON {$db_table}.current_version={$db_version_table}.version AND {$db_table}.id={$db_version_table}.{$parent_id} WHERE {$db_version_table}.id={$version[&#39;id&#39;]}&quot;</span>;
<a name="l00433"></a>00433                         <span class="keywordflow">break</span>;
<a name="l00434"></a>00434                 }
<a name="l00435"></a>00435         }
<a name="l00436"></a>00436         <span class="keywordflow">if</span> (!isset($version_sql)) {
<a name="l00437"></a>00437                 <span class="keywordflow">return</span> FALSE;
<a name="l00438"></a>00438         }
<a name="l00439"></a>00439         <a class="code" href="generateDataflowRDF_8php.html#a49a8a4009b02e49717caa88b128affc5" title="An SQL result for all the publically downloadable workflows that have dataflows that can be represent...">$res</a> = mysqli_query($con, $version_sql);
<a name="l00440"></a>00440         <span class="keywordflow">if</span> (mysqli_num_rows(<a class="code" href="generateDataflowRDF_8php.html#a49a8a4009b02e49717caa88b128affc5" title="An SQL result for all the publically downloadable workflows that have dataflows that can be represent...">$res</a>) &gt; 0) <span class="keywordflow">return</span> TRUE;
<a name="l00441"></a>00441         <span class="keywordflow">return</span> FALSE;
<a name="l00442"></a>00442 }
<a name="l00443"></a>00443 
<a name="l00456"></a><a class="code" href="property_8inc_8php.html#a34794ff24b93c9cfc7148c64d9f71921">00456</a> function <a class="code" href="property_8inc_8php.html#a34794ff24b93c9cfc7148c64d9f71921" title="Return RDF/XML mebase:has-version (or mepack:has-snapshot for Packs) properties for all versions of a...">getVersions</a>(<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>, $type){
<a name="l00457"></a>00457         global <a class="code" href="defaultsettings_8inc_8php.html#af3977e6112188cd0722cdde838f04c9d" title="A string specifying the base URI for any myExperiment RDF entities that are generated. (E.g. http://www.myexperiment.org/).">$datauri</a>, <a class="code" href="generateDataflowRDF_8php.html#a047170d6020a882807665812a27e2525" title="A string containing an SQL query to find all the publically downloadable workflows that have dataflow...">$sql</a>, <a class="code" href="data_8inc_8php.html#ab536a0d95f590a75a3a4e3228224e5eb" title="A multi-dimensional associative array specifying all the myExperiment entity types a particular piece...">$entities</a>;
<a name="l00458"></a>00458         <span class="keywordflow">if</span> (empty($entities[$type][<span class="stringliteral">&#39;version_entity&#39;</span>])) <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
<a name="l00459"></a>00459         $version_entity_type_name = $entities[$type][<span class="stringliteral">&#39;version_entity&#39;</span>];
<a name="l00460"></a>00460         $version_entity_type = $entities[$version_entity_type_name];
<a name="l00461"></a>00461         $versions_sql = $sql[$version_entity_type_name]. <span class="stringliteral">&quot; and {$version_entity_type[&#39;parent_id&#39;]}={$entity[&#39;id&#39;]}&quot;</span>;
<a name="l00462"></a>00462         <span class="keywordflow">if</span> (!empty(<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[<span class="stringliteral">&#39;current_version&#39;</span>])) {
<a name="l00463"></a>00463                 $versions_sql .= <span class="stringliteral">&quot; and version!={$entity[&#39;current_version&#39;]}&quot;</span>;
<a name="l00464"></a>00464         }
<a name="l00465"></a>00465         <a class="code" href="generateDataflowRDF_8php.html#a49a8a4009b02e49717caa88b128affc5" title="An SQL result for all the publically downloadable workflows that have dataflows that can be represent...">$res</a>=mysqli_query($con, $versions_sql);
<a name="l00466"></a>00466         $versions_rdf=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00467"></a>00467         <span class="keywordflow">if</span> ($type == <span class="stringliteral">&quot;Pack&quot;</span>) {
<a name="l00468"></a>00468                 $property_name = <span class="stringliteral">&quot;mepack:has-snapshot&quot;</span>;
<a name="l00469"></a>00469         }
<a name="l00470"></a>00470         <span class="keywordflow">else</span> {
<a name="l00471"></a>00471                 $property_name = <span class="stringliteral">&quot;mebase:has-version&quot;</span>;
<a name="l00472"></a>00472         }
<a name="l00473"></a>00473         <span class="keywordflow">for</span> ($i=0; $i&lt;mysqli_num_rows(<a class="code" href="generateDataflowRDF_8php.html#a49a8a4009b02e49717caa88b128affc5" title="An SQL result for all the publically downloadable workflows that have dataflows that can be represent...">$res</a>); $i++){
<a name="l00474"></a>00474                 $row=mysqli_fetch_assoc(<a class="code" href="generateDataflowRDF_8php.html#a49a8a4009b02e49717caa88b128affc5" title="An SQL result for all the publically downloadable workflows that have dataflows that can be represent...">$res</a>);
<a name="l00475"></a>00475                 $versions_rdf .= <span class="stringliteral">&quot;    &lt;$property_name rdf:resource=\&quot;&quot;</span>.$datauri.$entities[$type][<span class="stringliteral">&#39;url_subpath&#39;</span>].<span class="stringliteral">&quot;/&quot;</span>.<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[<span class="stringliteral">&#39;id&#39;</span>].<span class="stringliteral">&quot;/versions/&quot;</span>.$row[<span class="stringliteral">&#39;version&#39;</span>].<span class="stringliteral">&quot;\&quot;/&gt;\n&quot;</span>;
<a name="l00476"></a>00476         }
<a name="l00477"></a>00477         <span class="keywordflow">return</span> $versions_rdf;
<a name="l00478"></a>00478 }
<a name="l00479"></a>00479 
<a name="l00489"></a><a class="code" href="property_8inc_8php.html#a887e2eb6c16c0534b6742bf47a2b6d12">00489</a> function <a class="code" href="property_8inc_8php.html#a887e2eb6c16c0534b6742bf47a2b6d12" title="Return the URL for the picture (avatar) of a specified User (or the default avatar URL if they have n...">getPictureURL</a>($user){
<a name="l00490"></a>00490         global <a class="code" href="defaultsettings_8inc_8php.html#af3977e6112188cd0722cdde838f04c9d" title="A string specifying the base URI for any myExperiment RDF entities that are generated. (E.g. http://www.myexperiment.org/).">$datauri</a>;
<a name="l00491"></a>00491         <span class="keywordflow">if</span> (!empty($user[<span class="stringliteral">&#39;picture_id&#39;</span>])) <span class="keywordflow">return</span> $datauri.<span class="stringliteral">&quot;pictures/show/&quot;</span>.$user[<span class="stringliteral">&#39;picture_id&#39;</span>].<span class="stringliteral">&quot;?size=160x160.png&quot;</span>;
<a name="l00492"></a>00492         <span class="keywordflow">return</span> $datauri.<span class="stringliteral">&quot;images/avatar.png&quot;</span>;
<a name="l00493"></a>00493 }
<a name="l00494"></a>00494 
<a name="l00504"></a><a class="code" href="property_8inc_8php.html#a60e644441528407a39a390c7a8162dad">00504</a> function <a class="code" href="property_8inc_8php.html#a60e644441528407a39a390c7a8162dad" title="Return RDF/XML for the sioc:name and foaf:name properties (i.e. the User&amp;#39;s full name) for a speci...">getSIOCAndFOAFName</a>($user){
<a name="l00505"></a>00505         global <a class="code" href="data_8inc_8php.html#af11acd2654b41bde36cc9e8d38522ba2" title="An associative array mapping RDF properteries to their XML datatypes.">$datatypes</a>;
<a name="l00506"></a>00506         <span class="keywordflow">if</span> (isset($user[<span class="stringliteral">&#39;name&#39;</span>])) <span class="keywordflow">return</span> <span class="stringliteral">&quot;    &lt;sioc:name rdf:datatype=\&quot;&amp;xsd;&quot;</span>.$datatypes[<span class="stringliteral">&#39;sioc:name&#39;</span>].<span class="stringliteral">&quot;\&quot;&gt;$user[name]&lt;/sioc:name&gt;\n    &lt;foaf:name rdf:datatype=\&quot;&amp;xsd;&quot;</span>.$datatypes[<span class="stringliteral">&#39;foaf:name&#39;</span>].<span class="stringliteral">&quot;\&quot;&gt;$user[name]&lt;/foaf:name&gt;\n&quot;</span>;
<a name="l00507"></a>00507         <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
<a name="l00508"></a>00508 }  
<a name="l00509"></a>00509 
<a name="l00519"></a><a class="code" href="property_8inc_8php.html#af2be8b8eca65ada5a692efae3287354f">00519</a> function <a class="code" href="property_8inc_8php.html#af2be8b8eca65ada5a692efae3287354f" title="Get the SHA1 sum for a User&amp;#39;s email address. So they can be uniquely identified by someone who al...">getMboxSHA1Sum</a>($user){
<a name="l00520"></a>00520         <span class="keywordflow">if</span> (isset($user[<span class="stringliteral">&#39;email&#39;</span>])) <span class="keywordflow">return</span> sha1($user[<span class="stringliteral">&#39;email&#39;</span>]);
<a name="l00521"></a>00521         <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
<a name="l00522"></a>00522 }
<a name="l00523"></a>00523 
<a name="l00533"></a><a class="code" href="property_8inc_8php.html#a01a5bcb2fea7a1d84adf4adb0d48f820">00533</a> function <a class="code" href="property_8inc_8php.html#a01a5bcb2fea7a1d84adf4adb0d48f820" title="Generate a mailto URL for a specified User&amp;#39;s profile email address.">getMailtoProfile</a>($user){
<a name="l00534"></a>00534         <span class="keywordflow">if</span> (isset($user[<span class="stringliteral">&#39;profile_email&#39;</span>]) &amp;&amp; <a class="code" href="utility_8inc_8php.html#a7dd20da0d428d94fa4dad40bf7e90887" title="Validate that a string provided is a valid email address.">validateEmail</a>($user[<span class="stringliteral">&#39;profile_email&#39;</span>])) <span class="keywordflow">return</span> <span class="stringliteral">&quot;mailto:&quot;</span>.$user[<span class="stringliteral">&#39;profile_email&#39;</span>];
<a name="l00535"></a>00535 }
<a name="l00536"></a>00536 
<a name="l00546"></a><a class="code" href="property_8inc_8php.html#a27d381ba548ca23f2d1c0dfc1007fefe">00546</a> function <a class="code" href="property_8inc_8php.html#a27d381ba548ca23f2d1c0dfc1007fefe" title="Attempt to generate RDF/XML dbpedia:residence properties referencing existing DBPedia location URIs f...">getResidence</a>($user){
<a name="l00547"></a>00547         $residence=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00548"></a>00548         $mats=array(<span class="stringliteral">&quot;/&quot;</span>,<span class="stringliteral">&quot;,&quot;</span>,<span class="stringliteral">&quot;  &quot;</span>);
<a name="l00549"></a>00549         $reps=array(<span class="stringliteral">&quot; &quot;</span>,<span class="stringliteral">&quot;, &quot;</span>,<span class="stringliteral">&quot; &quot;</span>);
<a name="l00550"></a>00550         <span class="keywordflow">if</span> (!empty($user[<span class="stringliteral">&#39;location_city&#39;</span>])) $user[<span class="stringliteral">&#39;location_city&#39;</span>] = trim($user[<span class="stringliteral">&#39;location_city&#39;</span>]);
<a name="l00551"></a>00551         <span class="keywordflow">if</span> (!empty($user[<span class="stringliteral">&#39;location_country&#39;</span>])) $user[<span class="stringliteral">&#39;location_country&#39;</span>] = trim($user[<span class="stringliteral">&#39;location_country&#39;</span>]);
<a name="l00552"></a>00552         <span class="keywordflow">if</span>(!empty($user[<span class="stringliteral">&#39;location_city&#39;</span>])) {
<a name="l00553"></a>00553                 $city = str_replace(<span class="stringliteral">&quot;+&quot;</span>,<span class="stringliteral">&quot;_&quot;</span>,urlencode(<a class="code" href="utility_8inc_8php.html#aae4b577c3d3104882b7e1aec90d96931" title="Upper cases the first letter of each word in a string as long as it is not already fully upper case o...">convertToDBPediaResidenceString</a>(str_replace($mats,$reps,$user[<span class="stringliteral">&#39;location_city&#39;</span>]))));
<a name="l00554"></a>00554                 $residence.=<span class="stringliteral">&quot;    &lt;dbpedia:residence rdf:resource=\&quot;http://dbpedia.org/resource/$city\&quot;/&gt;\n&quot;</span>;
<a name="l00555"></a>00555         }
<a name="l00556"></a>00556         <span class="keywordflow">if</span>(!empty($user[<span class="stringliteral">&#39;location_country&#39;</span>])) {
<a name="l00557"></a>00557                 $country = str_replace(<span class="stringliteral">&quot;+&quot;</span>,<span class="stringliteral">&quot;_&quot;</span>,urlencode(<a class="code" href="utility_8inc_8php.html#aae4b577c3d3104882b7e1aec90d96931" title="Upper cases the first letter of each word in a string as long as it is not already fully upper case o...">convertToDBPediaResidenceString</a>(str_replace($mats,$reps,$user[<span class="stringliteral">&#39;location_country&#39;</span>]))));
<a name="l00558"></a>00558                 $residence.=<span class="stringliteral">&quot;    &lt;dbpedia:residence rdf:resource=\&quot;http://dbpedia.org/resource/$country\&quot;/&gt;\n&quot;</span>;
<a name="l00559"></a>00559         }
<a name="l00560"></a>00560         <span class="keywordflow">return</span> $residence;
<a name="l00561"></a>00561 }
<a name="l00562"></a>00562 
<a name="l00575"></a><a class="code" href="property_8inc_8php.html#aa73a80f85212c9c56887e1e5e0228555">00575</a> function <a class="code" href="property_8inc_8php.html#aa73a80f85212c9c56887e1e5e0228555" title="Get the URL for the HTML homepage for a specified entity.">getHomepage</a>(<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>, $type){
<a name="l00576"></a>00576         $url = <a class="code" href="property_8inc_8php.html#a5111c785fc992ce2d62ec8213ac3112b" title="Determine the URI for an entity from its type, ID and other fields retrieved from a database query...">getEntityURI</a>(<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>, $type);
<a name="l00577"></a>00577         <span class="keywordflow">if</span> (!empty($url)) <span class="keywordflow">return</span> $url . <span class="stringliteral">&quot;.html&quot;</span>;
<a name="l00578"></a>00578         <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;      
<a name="l00579"></a>00579 }
<a name="l00580"></a>00580 
<a name="l00593"></a><a class="code" href="property_8inc_8php.html#aac871c255428f96d655e970b8f1b4743">00593</a> function <a class="code" href="property_8inc_8php.html#aac871c255428f96d655e970b8f1b4743" title="Get the full filename with extension for a file associated with an entity.">getFilename</a>(<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>, $type){
<a name="l00594"></a>00594         <span class="keywordflow">if</span> (!empty(<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[<span class="stringliteral">&#39;unique_name&#39;</span>]) &amp;&amp; !empty(<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[<span class="stringliteral">&#39;file_ext&#39;</span>])) <span class="keywordflow">return</span> <a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[<span class="stringliteral">&#39;unique_name&#39;</span>].<span class="stringliteral">&quot;.&quot;</span>.<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[<span class="stringliteral">&#39;file_ext&#39;</span>];
<a name="l00595"></a>00595         <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span>;
<a name="l00596"></a>00596 }
<a name="l00597"></a>00597 
<a name="l00607"></a><a class="code" href="property_8inc_8php.html#a5d6034563c24a140d79108f14f84a2c0">00607</a> function <a class="code" href="property_8inc_8php.html#a5d6034563c24a140d79108f14f84a2c0" title="Generate mepack:has-entry RDF/XML properties for all the entries (i.e. LocalPackEntry, RemotePackEntry and RelationshipEntry) of a specified Pack.">getPackEntries</a>($pack){
<a name="l00608"></a>00608         global <a class="code" href="defaultsettings_8inc_8php.html#af3977e6112188cd0722cdde838f04c9d" title="A string specifying the base URI for any myExperiment RDF entities that are generated. (E.g. http://www.myexperiment.org/).">$datauri</a>, <a class="code" href="generateDataflowRDF_8php.html#a047170d6020a882807665812a27e2525" title="A string containing an SQL query to find all the publically downloadable workflows that have dataflow...">$sql</a>;
<a name="l00609"></a>00609         $lsql=$sql[<span class="stringliteral">&#39;LocalPackEntry&#39;</span>];
<a name="l00610"></a>00610         <span class="keywordflow">if</span> (stripos($lsql,<span class="stringliteral">&#39;where&#39;</span>)&gt;0) $lsql.=<span class="stringliteral">&quot; and &quot;</span>;
<a name="l00611"></a>00611         <span class="keywordflow">else</span> $lsql.=<span class="stringliteral">&quot; where &quot;</span>;  
<a name="l00612"></a>00612         $lsql.=<span class="stringliteral">&quot;pack_id=$pack[id]&quot;</span>;
<a name="l00613"></a>00613         <span class="keywordflow">if</span> (empty($pack[<span class="stringliteral">&#39;version&#39;</span>])) {
<a name="l00614"></a>00614                 $lsql.=<span class="stringliteral">&quot; and version IS NULL&quot;</span>;
<a name="l00615"></a>00615         }
<a name="l00616"></a>00616         <span class="keywordflow">else</span> {
<a name="l00617"></a>00617                 $lsql.= <span class="stringliteral">&quot; and version = {$pack[&#39;version&#39;]}&quot;</span>;
<a name="l00618"></a>00618         }
<a name="l00619"></a>00619         $lres=mysqli_query($con, $lsql);
<a name="l00620"></a>00620         <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00621"></a>00621         $packurl=<a class="code" href="property_8inc_8php.html#a5111c785fc992ce2d62ec8213ac3112b" title="Determine the URI for an entity from its type, ID and other fields retrieved from a database query...">getEntityURI</a>(<span class="stringliteral">&#39;Pack&#39;</span>,$pack[<span class="stringliteral">&#39;id&#39;</span>],$pack);
<a name="l00622"></a>00622         <span class="keywordflow">for</span> ($e=0; $e&lt;mysqli_num_rows($lres); $e++){
<a name="l00623"></a>00623                 <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>.=<span class="stringliteral">&quot;    &lt;mepack:has-entry rdf:resource=\&quot;$packurl/local_pack_entries/&quot;</span>.mysqli_result($lres,$e,<span class="stringliteral">&#39;id&#39;</span>).<span class="stringliteral">&quot;\&quot;/&gt;\n&quot;</span>;
<a name="l00624"></a>00624         }
<a name="l00625"></a>00625         $rsql=$sql[<span class="stringliteral">&#39;RemotePackEntry&#39;</span>];
<a name="l00626"></a>00626         <span class="keywordflow">if</span> (stripos($rsql,<span class="stringliteral">&#39;where&#39;</span>)&gt;0) $rsql.=<span class="stringliteral">&quot; and &quot;</span>;
<a name="l00627"></a>00627         <span class="keywordflow">else</span> $rsql.=<span class="stringliteral">&quot; where &quot;</span>;
<a name="l00628"></a>00628         $rsql.=<span class="stringliteral">&quot;pack_id=$pack[id]&quot;</span>;
<a name="l00629"></a>00629         $rres=mysqli_query($con, $rsql);
<a name="l00630"></a>00630         <span class="keywordflow">for</span> ($e=0; $e&lt;mysqli_num_rows($rres); $e++){
<a name="l00631"></a>00631                 <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>.=<span class="stringliteral">&quot;    &lt;mepack:has-entry rdf:resource=\&quot;$packurl/remote_pack_entries/&quot;</span>.mysqli_result($rres,$e,<span class="stringliteral">&#39;id&#39;</span>).<span class="stringliteral">&quot;\&quot;/&gt;\n&quot;</span>;
<a name="l00632"></a>00632         }
<a name="l00633"></a>00633         $prsql=$sql[<span class="stringliteral">&#39;RelationshipEntry&#39;</span>];
<a name="l00634"></a>00634         <span class="keywordflow">if</span> (stripos($prsql,<span class="stringliteral">&#39;where&#39;</span>)&gt;0) $prsql.=<span class="stringliteral">&quot; and &quot;</span>;
<a name="l00635"></a>00635         <span class="keywordflow">else</span> $prsql.=<span class="stringliteral">&quot; where &quot;</span>;
<a name="l00636"></a>00636         $prsql.=<span class="stringliteral">&quot;context_id=$pack[id]&quot;</span>;
<a name="l00637"></a>00637         $prres=mysqli_query($con, $prsql);
<a name="l00638"></a>00638         <span class="keywordflow">for</span> ($e=0; $e&lt;mysqli_num_rows($prres); $e++){
<a name="l00639"></a>00639                 <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>.=<span class="stringliteral">&quot;    &lt;mepack:has-entry rdf:resource=\&quot;$packurl/relationship_entries/&quot;</span>.mysqli_result($prres,$e,<span class="stringliteral">&#39;id&#39;</span>).<span class="stringliteral">&quot;\&quot;/&gt;\n&quot;</span>;
<a name="l00640"></a>00640         }
<a name="l00641"></a>00641         <span class="keywordflow">return</span> <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>;
<a name="l00642"></a>00642 }
<a name="l00643"></a>00643 
<a name="l00653"></a><a class="code" href="property_8inc_8php.html#a4633a376442d517f3fdddcf6f67af3fd">00653</a> function <a class="code" href="property_8inc_8php.html#a4633a376442d517f3fdddcf6f67af3fd" title="Generate an RDF/XML meexp:Data entity that references a piece of data generate as an output from an E...">getOutput</a>($job){
<a name="l00654"></a>00654         global <a class="code" href="defaultsettings_8inc_8php.html#af3977e6112188cd0722cdde838f04c9d" title="A string specifying the base URI for any myExperiment RDF entities that are generated. (E.g. http://www.myexperiment.org/).">$datauri</a>;
<a name="l00655"></a>00655         <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00656"></a>00656         <span class="keywordflow">if</span> (!empty($job[<span class="stringliteral">&#39;outputs_uri&#39;</span>])){               
<a name="l00657"></a>00657                 $uri=<a class="code" href="property_8inc_8php.html#a5111c785fc992ce2d62ec8213ac3112b" title="Determine the URI for an entity from its type, ID and other fields retrieved from a database query...">getEntityURI</a>(<span class="stringliteral">&#39;Job&#39;</span>, $job[<span class="stringliteral">&#39;id&#39;</span>], $job);
<a name="l00658"></a>00658                 <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>=<span class="stringliteral">&quot;&lt;meexp:Data rdf:about=\&quot;$uri/output\&quot;&gt;\n&quot;</span>;
<a name="l00659"></a>00659                 <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>.= <span class="stringliteral">&quot;        &lt;mebase:uri rdf:resource=\&quot;$job[outputs_uri]\&quot;/&gt;\n&quot;</span>;
<a name="l00660"></a>00660                 <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>.=<span class="stringliteral">&quot;      &lt;/meexp:Data&gt;&quot;</span>;
<a name="l00661"></a>00661         }
<a name="l00662"></a>00662         <span class="keywordflow">return</span> <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>;
<a name="l00663"></a>00663 }
<a name="l00664"></a>00664 
<a name="l00674"></a><a class="code" href="property_8inc_8php.html#abf13dc7bd1f1c1f7a8aef7b3bef678c9">00674</a> function <a class="code" href="property_8inc_8php.html#abf13dc7bd1f1c1f7a8aef7b3bef678c9" title="Generate an RDF/XML meexp:Data entity that references a piece of data that is an input to an Experime...">getInput</a>($job){
<a name="l00675"></a>00675         <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00676"></a>00676         <span class="keywordflow">if</span> (!empty($job[<span class="stringliteral">&#39;inputs_uri&#39;</span>]) || !empty($job[<span class="stringliteral">&#39;inputs_data&#39;</span>])) {
<a name="l00677"></a>00677                 $uri=<a class="code" href="property_8inc_8php.html#a5111c785fc992ce2d62ec8213ac3112b" title="Determine the URI for an entity from its type, ID and other fields retrieved from a database query...">getEntityURI</a>(<span class="stringliteral">&#39;Job&#39;</span>, $job [<span class="stringliteral">&#39;id&#39;</span>], $job);
<a name="l00678"></a>00678                 <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>=<span class="stringliteral">&quot;&lt;meexp:Data rdf:about=\&quot;$uri/input\&quot;&gt;\n&quot;</span>;
<a name="l00679"></a>00679                 <span class="keywordflow">if</span> (!empty($job[<span class="stringliteral">&#39;inputs_uri&#39;</span>])) <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>.= <span class="stringliteral">&quot;        &lt;mebase:uri rdf:resource=\&quot;$job[inputs_uri]\&quot;/&gt;\n&quot;</span>;
<a name="l00680"></a>00680                 <span class="keywordflow">if</span> (!empty($job[<span class="stringliteral">&#39;inputs_data&#39;</span>])) <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>.= <span class="stringliteral">&quot;        &lt;mebase:text rdf:datatype=\&quot;&amp;xsd;string\&quot;&gt;$job[inputs_data]&lt;/mebase:text&gt;\n&quot;</span>;
<a name="l00681"></a>00681                 <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>.=<span class="stringliteral">&quot;      &lt;/meexp:Data&gt;&quot;</span>;
<a name="l00682"></a>00682         }
<a name="l00683"></a>00683         <span class="keywordflow">return</span> <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>;
<a name="l00684"></a>00684 }
<a name="l00685"></a>00685 
<a name="l00695"></a><a class="code" href="property_8inc_8php.html#a7ef042fb0d509dba1d3edca23495193d">00695</a> function <a class="code" href="property_8inc_8php.html#a7ef042fb0d509dba1d3edca23495193d" title="Get the URI of the Runnable entity of a specified Experiment Job. (I.e. a Workflow or WorkflowVersion...">getRunnable</a>($job) {
<a name="l00696"></a>00696         global <a class="code" href="data_8inc_8php.html#ab536a0d95f590a75a3a4e3228224e5eb" title="A multi-dimensional associative array specifying all the myExperiment entity types a particular piece...">$entities</a>, <a class="code" href="data_8inc_8php.html#a77de31c759b8ff4ccaa90c0d27bf9d25" title="An associative array mapping entity types in the database to myExperiment entity types (as defined wi...">$db_entity_mappings</a>;
<a name="l00697"></a>00697         $runnable_type = $db_entity_mappings[$job[<span class="stringliteral">&#39;runnable_type&#39;</span>]];
<a name="l00698"></a>00698         $runnable = $entities[$runnable_type][<span class="stringliteral">&#39;url_subpath&#39;</span>].<span class="stringliteral">&quot;/&quot;</span>.$job[<span class="stringliteral">&#39;runnable_id&#39;</span>];
<a name="l00699"></a>00699         <span class="keywordflow">if</span> (!empty($job[<span class="stringliteral">&#39;runnable_version&#39;</span>])) $runnable.=<span class="stringliteral">&quot;/versions/&quot;</span>.$job[<span class="stringliteral">&#39;runnable_version&#39;</span>];
<a name="l00700"></a>00700         <span class="keywordflow">return</span> $runnable;
<a name="l00701"></a>00701 }
<a name="l00702"></a>00702 
<a name="l00712"></a><a class="code" href="property_8inc_8php.html#a4d52e7378e462558fc0288b36a2bbe12">00712</a> function <a class="code" href="property_8inc_8php.html#a4d52e7378e462558fc0288b36a2bbe12" title="Get the path of the URI (to which the $datauri can be prepended) for the Runner (e.g. TavernaEnactor) of a specified Experiment Job.">getRunner</a>($job){
<a name="l00713"></a>00713         <span class="keywordflow">return</span> <span class="stringliteral">&quot;runners/$job[runner_id]&quot;</span>;
<a name="l00714"></a>00714 }
<a name="l00715"></a>00715 
<a name="l00725"></a><a class="code" href="property_8inc_8php.html#aa5a12da128fc51fe9bf87a5e1e4a7b58">00725</a> function <a class="code" href="property_8inc_8php.html#aa5a12da128fc51fe9bf87a5e1e4a7b58" title="Determine either a myExperiment entity URI or generate an rdf:Description RDF/XML for a remote entity...">getProxyFor</a>($pack_entry){
<a name="l00726"></a>00726         global <a class="code" href="data_8inc_8php.html#ab536a0d95f590a75a3a4e3228224e5eb" title="A multi-dimensional associative array specifying all the myExperiment entity types a particular piece...">$entities</a>, <a class="code" href="data_8inc_8php.html#a77de31c759b8ff4ccaa90c0d27bf9d25" title="An associative array mapping entity types in the database to myExperiment entity types (as defined wi...">$db_entity_mappings</a>;
<a name="l00727"></a>00727         <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00728"></a>00728         <span class="keywordflow">if</span> (isset($pack_entry[<span class="stringliteral">&#39;contributable_type&#39;</span>])){
<a name="l00729"></a>00729                 $entity_type_name = $db_entity_mappings[$pack_entry[<span class="stringliteral">&#39;contributable_type&#39;</span>]];
<a name="l00730"></a>00730                 <span class="keywordflow">return</span> <a class="code" href="property_8inc_8php.html#a5111c785fc992ce2d62ec8213ac3112b" title="Determine the URI for an entity from its type, ID and other fields retrieved from a database query...">getEntityURI</a>($entity_type_name, $pack_entry[<span class="stringliteral">&#39;contributable_id&#39;</span>], $pack_entry);
<a name="l00731"></a>00731         }
<a name="l00732"></a>00732         <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>.=<span class="stringliteral">&quot;&lt;rdf:Description rdf:about=\&quot;&quot;</span>.str_replace(<span class="stringliteral">&quot;&amp;&quot;</span>,<span class="stringliteral">&quot;&amp;amp;&quot;</span>,$pack_entry[<span class="stringliteral">&#39;uri&#39;</span>]).<span class="stringliteral">&quot;\&quot;&quot;</span>;
<a name="l00733"></a>00733         <span class="keywordflow">if</span> (!empty($pack_entry[<span class="stringliteral">&#39;alternate_uri&#39;</span>])) <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>.=<span class="stringliteral">&quot;&gt;\n      &lt;rdfs:seeAlso&gt;\n        &lt;rdf:Description rdf:about=\&quot;&quot;</span>.str_replace(<span class="stringliteral">&quot;&amp;&quot;</span>,<span class="stringliteral">&quot;&amp;amp;&quot;</span>,$pack_entry[<span class="stringliteral">&#39;alternate_uri&#39;</span>]).<span class="stringliteral">&quot;\&quot;/&gt;\n      &lt;/rdfs:seeAlso&gt;\n    &lt;/rdf:Description&gt;\n&quot;</span>;
<a name="l00734"></a>00734         <span class="keywordflow">else</span> <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>.=<span class="stringliteral">&quot;/&gt;&quot;</span>;
<a name="l00735"></a>00735         <span class="keywordflow">return</span> <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>;
<a name="l00736"></a>00736 }
<a name="l00737"></a>00737 
<a name="l00750"></a><a class="code" href="property_8inc_8php.html#a453360cc660bd7b204bf5ce2a447153c">00750</a> function <a class="code" href="property_8inc_8php.html#a453360cc660bd7b204bf5ce2a447153c" title="Get the URI for the Dataflow for a specified Workflow / WorkflowVersion, assuming that the user reque...">getDataflow</a>(<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>,$type){
<a name="l00751"></a>00751         <span class="keywordflow">if</span> (<a class="code" href="rdf_8inc_8php.html#a11be21d7a973493c55c07a641155396a" title="Determine whether the User requesting RDF has permission to download a specific downloadable entity...">canUserDownload</a>(<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>)) <span class="keywordflow">return</span> <a class="code" href="property_8inc_8php.html#afb8cdf85cf65c3273d93a3c683d2c84e" title="Get the URI for the Dataflow for a specified Workflow / WorkflowVersion. If available and not already...">getDataflowComponents</a>(<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>,$type,FALSE);        
<a name="l00752"></a>00752         <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
<a name="l00753"></a>00753 }
<a name="l00754"></a>00754 
<a name="l00770"></a><a class="code" href="property_8inc_8php.html#afb8cdf85cf65c3273d93a3c683d2c84e">00770</a> function <a class="code" href="property_8inc_8php.html#afb8cdf85cf65c3273d93a3c683d2c84e" title="Get the URI for the Dataflow for a specified Workflow / WorkflowVersion. If available and not already...">getDataflowComponents</a>(<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>,$type,$retrieve=TRUE){
<a name="l00771"></a>00771         global <a class="code" href="defaultsettings_8inc_8php.html#af3977e6112188cd0722cdde838f04c9d" title="A string specifying the base URI for any myExperiment RDF entities that are generated. (E.g. http://www.myexperiment.org/).">$datauri</a>,<a class="code" href="defaultsettings_8inc_8php.html#af7742a24d8c1298570a7364e0692709a" title="A string specifying the path where RDF and other data files generated by myExperiment Linked Data scr...">$datapath</a>,<a class="code" href="defaultsettings_8inc_8php.html#a29cc3df12735f5a72e200a146c12801c" title="A string specifying where the myExperiment Ruby-on-Rails application resides if it is deployed locall...">$myexppath</a>,<a class="code" href="defaultsettings_8inc_8php.html#a57c4524da04a2cc05251c8715b9c4a32" title="A boolean specifying whether rake can be invoked to retrieve data from a Ruby-on-Rail application...">$use_rake</a>;
<a name="l00772"></a>00772         $comp_path=$datapath.<span class="stringliteral">&quot;dataflows/&quot;</span>;
<a name="l00773"></a>00773         <a class="code" href="generateDataflowRDF_8php.html#a047170d6020a882807665812a27e2525" title="A string containing an SQL query to find all the publically downloadable workflows that have dataflow...">$sql</a>=<span class="stringliteral">&quot;select workflow_versions.*, content_types.mime_type from workflow_versions inner join content_types on workflow_versions.content_type_id=content_types.id where &quot;</span>;
<a name="l00774"></a>00774         <span class="keywordflow">if</span> ($type==<span class="stringliteral">&quot;Workflow&quot;</span>) <a class="code" href="generateDataflowRDF_8php.html#a047170d6020a882807665812a27e2525" title="A string containing an SQL query to find all the publically downloadable workflows that have dataflow...">$sql</a>.=<span class="stringliteral">&quot;version=&#39;$entity[current_version]&#39; and workflow_id=&#39;$entity[id]&#39;&quot;</span>;
<a name="l00775"></a>00775         elseif ($type==<span class="stringliteral">&quot;WorkflowVersion&quot;</span>) <a class="code" href="generateDataflowRDF_8php.html#a047170d6020a882807665812a27e2525" title="A string containing an SQL query to find all the publically downloadable workflows that have dataflow...">$sql</a>.=<span class="stringliteral">&quot;workflow_versions.id=&#39;$entity[id]&#39;&quot;</span>;
<a name="l00776"></a>00776         <a class="code" href="generateDataflowRDF_8php.html#a49a8a4009b02e49717caa88b128affc5" title="An SQL result for all the publically downloadable workflows that have dataflows that can be represent...">$res</a>=mysqli_query(<a class="code" href="generateDataflowRDF_8php.html#a047170d6020a882807665812a27e2525" title="A string containing an SQL query to find all the publically downloadable workflows that have dataflow...">$sql</a>);
<a name="l00777"></a>00777         $wfv=mysqli_fetch_assoc(<a class="code" href="generateDataflowRDF_8php.html#a49a8a4009b02e49717caa88b128affc5" title="An SQL result for all the publically downloadable workflows that have dataflows that can be represent...">$res</a>);
<a name="l00778"></a>00778         $ent_uri=$datauri.<span class="stringliteral">&quot;workflows/$wfv[workflow_id]/versions/$wfv[version]&quot;</span>;
<a name="l00779"></a>00779         <span class="keywordflow">if</span> ($wfv[<span class="stringliteral">&#39;mime_type&#39;</span>]==<span class="stringliteral">&#39;application/vnd.taverna.t2flow+xml&#39;</span>) $df_uri=<span class="stringliteral">&quot;$ent_uri#dataflows/1&quot;</span>;
<a name="l00780"></a>00780         <span class="keywordflow">else</span> $df_uri=<span class="stringliteral">&quot;$ent_uri#dataflow&quot;</span>;
<a name="l00781"></a>00781         $fileloc=$comp_path.$wfv[<span class="stringliteral">&#39;id&#39;</span>];
<a name="l00782"></a>00782         <span class="keywordflow">if</span> (!file_exists($fileloc) &amp;&amp; $use_rake) <a class="code" href="rdf_8inc_8php.html#af752f46232808646741465aa901c0e2d" title="Write to a local file the RDF/XML to represent the Dataflow for a specified WorkflowVersion.">writeDataflowToFile</a>($wfv[<span class="stringliteral">&#39;id&#39;</span>],$ent_uri,$fileloc,$wfv[<span class="stringliteral">&#39;mime_type&#39;</span>]);
<a name="l00783"></a>00783         <span class="keywordflow">if</span> (file_exists($fileloc)) <a class="code" href="ontent_8php.html#a470f99c17f2e6f0a5a7b96f44cfc46a5" title="An array containing every line of the ontology file requested.">$lines</a>=file($fileloc);
<a name="l00784"></a>00784         <span class="keywordflow">else</span> <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
<a name="l00785"></a>00785         <span class="keywordflow">if</span> (trim(<a class="code" href="ontent_8php.html#a470f99c17f2e6f0a5a7b96f44cfc46a5" title="An array containing every line of the ontology file requested.">$lines</a>[0])==<span class="stringliteral">&quot;NONE&quot;</span>) <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
<a name="l00786"></a>00786         elseif($retrieve==<span class="keyword">false</span>) <span class="keywordflow">return</span> $df_uri;
<a name="l00787"></a>00787         <span class="keywordflow">return</span> implode(<span class="stringliteral">&quot;&quot;</span>,<a class="code" href="ontent_8php.html#a470f99c17f2e6f0a5a7b96f44cfc46a5" title="An array containing every line of the ontology file requested.">$lines</a>);
<a name="l00788"></a>00788 }
<a name="l00789"></a>00789         
<a name="l00799"></a><a class="code" href="property_8inc_8php.html#adf2baaf819f0f47890b5e76b7908d5cb">00799</a> function <a class="code" href="property_8inc_8php.html#adf2baaf819f0f47890b5e76b7908d5cb" title="Get the Creative Commons RDF/XML License attribute properties for a specified License.">getLicenseAttributes</a>($license){
<a name="l00800"></a>00800         <a class="code" href="generateDataflowRDF_8php.html#a047170d6020a882807665812a27e2525" title="A string containing an SQL query to find all the publically downloadable workflows that have dataflow...">$sql</a>=<span class="stringliteral">&quot;select license_options.* from license_attributes inner join license_options on license_attributes.license_option_id=license_options.id where license_attributes.license_id={$license[&#39;id&#39;]}&quot;</span>;
<a name="l00801"></a>00801         <a class="code" href="generateDataflowRDF_8php.html#a49a8a4009b02e49717caa88b128affc5" title="An SQL result for all the publically downloadable workflows that have dataflows that can be represent...">$res</a>=mysqli_query(<a class="code" href="generateDataflowRDF_8php.html#a047170d6020a882807665812a27e2525" title="A string containing an SQL query to find all the publically downloadable workflows that have dataflow...">$sql</a>);
<a name="l00802"></a>00802         <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00803"></a>00803         <span class="keywordflow">for</span> ($a=0; $a&lt;mysqli_num_rows(<a class="code" href="generateDataflowRDF_8php.html#a49a8a4009b02e49717caa88b128affc5" title="An SQL result for all the publically downloadable workflows that have dataflows that can be represent...">$res</a>); $a++){
<a name="l00804"></a>00804                 $row=mysqli_fetch_array(<a class="code" href="generateDataflowRDF_8php.html#a49a8a4009b02e49717caa88b128affc5" title="An SQL result for all the publically downloadable workflows that have dataflows that can be represent...">$res</a>);
<a name="l00805"></a>00805                 <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>.=<span class="stringliteral">&quot;    &lt;cc:{$row[&#39;predicate&#39;]} rdf:resource=\&quot;{$row[&#39;uri&#39;]}\&quot;/&gt;\n&quot;</span>;
<a name="l00806"></a>00806         }   
<a name="l00807"></a>00807         <span class="keywordflow">return</span> <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>;
<a name="l00808"></a>00808 }
<a name="l00809"></a>00809 
<a name="l00822"></a><a class="code" href="property_8inc_8php.html#abd89ecc3178f28c5d30a302c17168426">00822</a> function <a class="code" href="property_8inc_8php.html#abd89ecc3178f28c5d30a302c17168426" title="Generate RDF/XML properties for annotations of all types for a specified entity.">getAnnotations</a>(<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>, $type){
<a name="l00823"></a>00823         global <a class="code" href="data_8inc_8php.html#ab536a0d95f590a75a3a4e3228224e5eb" title="A multi-dimensional associative array specifying all the myExperiment entity types a particular piece...">$entities</a>, <a class="code" href="data_8inc_8php.html#a77de31c759b8ff4ccaa90c0d27bf9d25" title="An associative array mapping entity types in the database to myExperiment entity types (as defined wi...">$db_entity_mappings</a>;
<a name="l00824"></a>00824         <span class="keywordflow">if</span> (empty($entities[$type][<span class="stringliteral">&#39;annotations&#39;</span>])) {
<a name="l00825"></a>00825                 <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
<a name="l00826"></a>00826         }
<a name="l00827"></a>00827         $annotations = $entities[$type][<span class="stringliteral">&#39;annotations&#39;</span>];
<a name="l00828"></a>00828         <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a> = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00829"></a>00829         <span class="keywordflow">foreach</span> ($annotations as $annotation){
<a name="l00830"></a>00830                 <span class="keywordflow">if</span> ($annotation == <span class="stringliteral">&quot;Citation&quot;</span>) $annot_sql=<a class="code" href="sql_8inc_8php.html#ab92965af5447b6e41955b0306706ac80" title="Generate an SQL query that will find all annotations of a specified type for a specified entity...">getAnnotationSQL</a>($annotation, <a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[<span class="stringliteral">&#39;workflow_id&#39;</span>], <a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[<span class="stringliteral">&#39;version&#39;</span>]);
<a name="l00831"></a>00831                 <span class="keywordflow">else</span> $annot_sql=<a class="code" href="sql_8inc_8php.html#ab92965af5447b6e41955b0306706ac80" title="Generate an SQL query that will find all annotations of a specified type for a specified entity...">getAnnotationSQL</a>($annotation, $type, <a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[<span class="stringliteral">&#39;id&#39;</span>]);
<a name="l00832"></a>00832                 <span class="comment">//error_log($annot_sql);</span>
<a name="l00833"></a>00833                 <a class="code" href="generateDataflowRDF_8php.html#a49a8a4009b02e49717caa88b128affc5" title="An SQL result for all the publically downloadable workflows that have dataflows that can be represent...">$res</a> = mysqli_query($con, $annot_sql);
<a name="l00834"></a>00834                 <span class="keywordflow">for</span> ($a=0; $a&lt;mysqli_num_rows(<a class="code" href="generateDataflowRDF_8php.html#a49a8a4009b02e49717caa88b128affc5" title="An SQL result for all the publically downloadable workflows that have dataflows that can be represent...">$res</a>); $a++){
<a name="l00835"></a>00835                         $row = mysqli_fetch_assoc(<a class="code" href="generateDataflowRDF_8php.html#a49a8a4009b02e49717caa88b128affc5" title="An SQL result for all the publically downloadable workflows that have dataflows that can be represent...">$res</a>);
<a name="l00836"></a>00836                         $annot_uri=<a class="code" href="property_8inc_8php.html#a5111c785fc992ce2d62ec8213ac3112b" title="Determine the URI for an entity from its type, ID and other fields retrieved from a database query...">getEntityURI</a>($annotation, $row[<span class="stringliteral">&#39;id&#39;</span>], $row);
<a name="l00837"></a>00837                         <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>.=<span class="stringliteral">&quot;    &lt;meannot:&quot;</span>.$entities[$annotation][<span class="stringliteral">&#39;annotation_property&#39;</span>].<span class="stringliteral">&quot; rdf:resource=\&quot;$annot_uri\&quot;/&gt;\n&quot;</span>;
<a name="l00838"></a>00838                 }
<a name="l00839"></a>00839         }
<a name="l00840"></a>00840         <span class="keywordflow">return</span> <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>;
<a name="l00841"></a>00841 }
<a name="l00842"></a>00842 
<a name="l00852"></a><a class="code" href="property_8inc_8php.html#a0642e56aef527ef3a17381e448740c7f">00852</a> function <a class="code" href="property_8inc_8php.html#a0642e56aef527ef3a17381e448740c7f" title="Generates RDF/XML properties for relationships between the specified Predicate and other Predicates...">getPredicateRelations</a>(<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>){
<a name="l00853"></a>00853         global <a class="code" href="generateDataflowRDF_8php.html#a047170d6020a882807665812a27e2525" title="A string containing an SQL query to find all the publically downloadable workflows that have dataflow...">$sql</a>, <a class="code" href="defaultsettings_8inc_8php.html#af3977e6112188cd0722cdde838f04c9d" title="A string specifying the base URI for any myExperiment RDF entities that are generated. (E.g. http://www.myexperiment.org/).">$datauri</a>;
<a name="l00854"></a>00854         <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00855"></a>00855         $predicatesql=$sql[<span class="stringliteral">&#39;PredicateRelation&#39;</span>];
<a name="l00856"></a>00856         <span class="keywordflow">if</span> (!stripos(<span class="stringliteral">&#39;where&#39;</span>,$sql[<span class="stringliteral">&#39;PredicateRelation&#39;</span>])) $predicatesql.=<span class="stringliteral">&quot; where &quot;</span>;
<a name="l00857"></a>00857         <span class="keywordflow">else</span> $predicatesql.=<span class="stringliteral">&quot; and &quot;</span>;
<a name="l00858"></a>00858         $predicaterelsql=$predicatesql.<span class="stringliteral">&quot;subject_predicate_id=$entity[id]&quot;</span>;
<a name="l00859"></a>00859         <a class="code" href="generateDataflowRDF_8php.html#a49a8a4009b02e49717caa88b128affc5" title="An SQL result for all the publically downloadable workflows that have dataflows that can be represent...">$res</a>=mysqli_query($con, $predicaterelsql);
<a name="l00860"></a>00860         <span class="keywordflow">if</span> (<a class="code" href="generateDataflowRDF_8php.html#a49a8a4009b02e49717caa88b128affc5" title="An SQL result for all the publically downloadable workflows that have dataflows that can be represent...">$res</a>!==<span class="keyword">false</span>){
<a name="l00861"></a>00861                 <span class="keywordflow">for</span> ($r=0; $r&lt;mysqli_num_rows(<a class="code" href="generateDataflowRDF_8php.html#a49a8a4009b02e49717caa88b128affc5" title="An SQL result for all the publically downloadable workflows that have dataflows that can be represent...">$res</a>); $r++){
<a name="l00862"></a>00862                         $row=mysqli_fetch_assoc(<a class="code" href="generateDataflowRDF_8php.html#a49a8a4009b02e49717caa88b128affc5" title="An SQL result for all the publically downloadable workflows that have dataflows that can be represent...">$res</a>);
<a name="l00863"></a>00863                         <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>.=<span class="stringliteral">&quot;    &lt;rdfs:subClassOf rdf:resource=\&quot;$entity[ontology_uri]/$row[object_predicate_id]\&quot;/&gt;\n&quot;</span>;
<a name="l00864"></a>00864                 }
<a name="l00865"></a>00865         }
<a name="l00866"></a>00866         <span class="keywordflow">return</span> <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>;
<a name="l00867"></a>00867 }
<a name="l00868"></a>00868 
<a name="l00878"></a><a class="code" href="property_8inc_8php.html#a8c360395168871a91bdde4d0b20fa732">00878</a> function <a class="code" href="property_8inc_8php.html#a8c360395168871a91bdde4d0b20fa732" title="Generate an associative array containing the subject, predicate and object representing the Relations...">getRelationshipSPO</a>(<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>){
<a name="l00879"></a>00879         <span class="keywordflow">return</span> array(<span class="stringliteral">&#39;subject&#39;</span>=&gt;<a class="code" href="property_8inc_8php.html#a433e8138118db9e6f3398f95011809c3" title="Get the URI for the subject of a Relationship entity.">getRelationshipSubject</a>(<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>),<span class="stringliteral">&#39;predicate&#39;</span>=&gt;<a class="code" href="property_8inc_8php.html#a1baa2e0b61959002cbe60e728576b358" title="Get the URI for the predicate of a Relationship entity.">getRelationshipPredicate</a>(<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>),<span class="stringliteral">&#39;object&#39;</span>=&gt;<a class="code" href="property_8inc_8php.html#a3d7bb8764cee230e8c9e5ddc9af22381" title="Get the URI for the object of a Relationship entity.">getRelationshipObject</a>(<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>));
<a name="l00880"></a>00880 }
<a name="l00881"></a>00881 
<a name="l00891"></a><a class="code" href="property_8inc_8php.html#adee3ea5a7211b9b9b433ff5d321339ae">00891</a> function <a class="code" href="property_8inc_8php.html#adee3ea5a7211b9b9b433ff5d321339ae" title="Generate a version 5 (RFC4122) UUID to provide a URN for the specific Relationship. Using the URIs for the subject, predicate and object of the Relationship.">getRelationshipURN</a>($spo){
<a name="l00892"></a>00892         require_once(<span class="stringliteral">&#39;class.uuid.php&#39;</span>);
<a name="l00893"></a>00893         <span class="keywordflow">return</span> <span class="stringliteral">&quot;urn:uuid:&quot;</span>.UUID::generate(<a class="code" href="classUUID.html#a4e17a0852f6194b41b2b9338684720bc" title="Name based (SHA1) UUID.">UUID::UUID_NAME_SHA1</a>,<a class="code" href="classUUID.html#a6b27d1bd637e4ee9342651a4a1fbca08" title="String format.">UUID::FMT_STRING</a>,$spo[<span class="stringliteral">&#39;subject&#39;</span>].$spo[<span class="stringliteral">&#39;predicate&#39;</span>].$spo[<span class="stringliteral">&#39;object&#39;</span>]);
<a name="l00894"></a>00894 }
<a name="l00895"></a>00895 
<a name="l00905"></a><a class="code" href="property_8inc_8php.html#a4111a8dce23969477f2fedb45bfec996">00905</a> function <a class="code" href="property_8inc_8php.html#a4111a8dce23969477f2fedb45bfec996" title="Generate an ore:ProxyFor RDF/XML property with an encapsulated mepack:Relationship entity for a speci...">getRelationship</a>(<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>){
<a name="l00906"></a>00906         $spo=<a class="code" href="property_8inc_8php.html#a8c360395168871a91bdde4d0b20fa732" title="Generate an associative array containing the subject, predicate and object representing the Relations...">getRelationshipSPO</a>(<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>);
<a name="l00907"></a>00907         $urn=<a class="code" href="property_8inc_8php.html#adee3ea5a7211b9b9b433ff5d321339ae" title="Generate a version 5 (RFC4122) UUID to provide a URN for the specific Relationship. Using the URIs for the subject, predicate and object of the Relationship.">getRelationshipURN</a>($spo);
<a name="l00908"></a>00908         <span class="keywordflow">return</span> <span class="stringliteral">&quot;    &lt;ore:proxyFor&gt;\n      &lt;mepack:Relationship rdf:about=\&quot;$urn\&quot;&gt;\n        &lt;rdf:subject rdf:resource=\&quot;$spo[subject]\&quot;/&gt;\n        &lt;rdf:predicate rdf:resource=\&quot;$spo[predicate]\&quot;/&gt;\n        &lt;rdf:object rdf:resource=\&quot;$spo[object]\&quot;/&gt;\n      &lt;/mepack:Relationship&gt;\n    &lt;/ore:proxyFor&gt;\n&quot;</span>;
<a name="l00909"></a>00909 }
<a name="l00910"></a>00910 
<a name="l00920"></a><a class="code" href="property_8inc_8php.html#a433e8138118db9e6f3398f95011809c3">00920</a> function <a class="code" href="property_8inc_8php.html#a433e8138118db9e6f3398f95011809c3" title="Get the URI for the subject of a Relationship entity.">getRelationshipSubject</a>(<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>){
<a name="l00921"></a>00921         <span class="keywordflow">return</span> <a class="code" href="property_8inc_8php.html#a2db8ce2a89c67886fc6ba254a2f32801" title="Get the URI for a node (subject or object) of a Relationship entity.">getRelationshipNode</a>(<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[<span class="stringliteral">&#39;subject_id&#39;</span>],<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[<span class="stringliteral">&#39;subject_type&#39;</span>]);
<a name="l00922"></a>00922 }
<a name="l00923"></a>00923 
<a name="l00933"></a><a class="code" href="property_8inc_8php.html#a3d7bb8764cee230e8c9e5ddc9af22381">00933</a> function <a class="code" href="property_8inc_8php.html#a3d7bb8764cee230e8c9e5ddc9af22381" title="Get the URI for the object of a Relationship entity.">getRelationshipObject</a>(<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>){
<a name="l00934"></a>00934         <span class="keywordflow">return</span> <a class="code" href="property_8inc_8php.html#a2db8ce2a89c67886fc6ba254a2f32801" title="Get the URI for a node (subject or object) of a Relationship entity.">getRelationshipNode</a>(<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[<span class="stringliteral">&#39;objekt_id&#39;</span>],<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[<span class="stringliteral">&#39;objekt_type&#39;</span>]);
<a name="l00935"></a>00935 }
<a name="l00936"></a>00936 
<a name="l00946"></a><a class="code" href="property_8inc_8php.html#a1baa2e0b61959002cbe60e728576b358">00946</a> function <a class="code" href="property_8inc_8php.html#a1baa2e0b61959002cbe60e728576b358" title="Get the URI for the predicate of a Relationship entity.">getRelationshipPredicate</a>(<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>){
<a name="l00947"></a>00947         <span class="keywordflow">return</span> <a class="code" href="property_8inc_8php.html#afdc616efb63a7f9a6c516c65bdb0f542" title="Generate the URI for a predicate based on its ID value in the database.">getPredicate</a>(<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[<span class="stringliteral">&#39;predicate_id&#39;</span>]);
<a name="l00948"></a>00948 }
<a name="l00949"></a>00949 
<a name="l00962"></a><a class="code" href="property_8inc_8php.html#a2db8ce2a89c67886fc6ba254a2f32801">00962</a> function <a class="code" href="property_8inc_8php.html#a2db8ce2a89c67886fc6ba254a2f32801" title="Get the URI for a node (subject or object) of a Relationship entity.">getRelationshipNode</a>($id,$type){
<a name="l00963"></a>00963         global <a class="code" href="defaultsettings_8inc_8php.html#af3977e6112188cd0722cdde838f04c9d" title="A string specifying the base URI for any myExperiment RDF entities that are generated. (E.g. http://www.myexperiment.org/).">$datauri</a>, <a class="code" href="data_8inc_8php.html#ab536a0d95f590a75a3a4e3228224e5eb" title="A multi-dimensional associative array specifying all the myExperiment entity types a particular piece...">$entities</a>, <a class="code" href="data_8inc_8php.html#a77de31c759b8ff4ccaa90c0d27bf9d25" title="An associative array mapping entity types in the database to myExperiment entity types (as defined wi...">$db_entity_mappings</a>;
<a name="l00964"></a>00964         $oetype = $db_entity_mappings[$type];
<a name="l00965"></a>00965         $node_sql=<span class="stringliteral">&quot;select * from {$entities[$type][&#39;table&#39;]} where id = $id&quot;</span>;
<a name="l00966"></a>00966         <a class="code" href="generateDataflowRDF_8php.html#a49a8a4009b02e49717caa88b128affc5" title="An SQL result for all the publically downloadable workflows that have dataflows that can be represent...">$res</a>=mysqli_query($con, $node_sql);
<a name="l00967"></a>00967         $row=mysqli_fetch_assoc(<a class="code" href="generateDataflowRDF_8php.html#a49a8a4009b02e49717caa88b128affc5" title="An SQL result for all the publically downloadable workflows that have dataflows that can be represent...">$res</a>);
<a name="l00968"></a>00968         <span class="keywordflow">if</span> ($type==<span class="stringliteral">&quot;PackRemoteEntry&quot;</span>) <span class="keywordflow">return</span> $row[<span class="stringliteral">&#39;uri&#39;</span>];
<a name="l00969"></a>00969         <span class="keywordflow">if</span> ($type==<span class="stringliteral">&quot;PackContributableEntry&quot;</span>){
<a name="l00970"></a>00970                 $uri = $datauri.$db_entity_mappings[$row[<span class="stringliteral">&#39;contributable_type&#39;</span>]].<span class="stringliteral">&quot;/&quot;</span>.$row[<span class="stringliteral">&#39;contributable_id&#39;</span>];
<a name="l00971"></a>00971                 <span class="keywordflow">if</span> ($row[<span class="stringliteral">&#39;contributable_version&#39;</span>]) <span class="keywordflow">return</span> $uri.<span class="stringliteral">&quot;/versions/&quot;</span>.$row[<span class="stringliteral">&#39;contributable_version&#39;</span>];
<a name="l00972"></a>00972                 <span class="keywordflow">return</span> $uri;
<a name="l00973"></a>00973         }
<a name="l00974"></a>00974 }
<a name="l00975"></a>00975 
<a name="l00985"></a><a class="code" href="property_8inc_8php.html#afdc616efb63a7f9a6c516c65bdb0f542">00985</a> function <a class="code" href="property_8inc_8php.html#afdc616efb63a7f9a6c516c65bdb0f542" title="Generate the URI for a predicate based on its ID value in the database.">getPredicate</a>($id){
<a name="l00986"></a>00986         $predsql=<span class="stringliteral">&quot;select ontologies.uri as ontology_uri, predicates.title as predicate from predicates inner join ontologies on predicates.ontology_id=ontologies.id where predicates.id=$id&quot;</span>;
<a name="l00987"></a>00987         <a class="code" href="generateDataflowRDF_8php.html#a49a8a4009b02e49717caa88b128affc5" title="An SQL result for all the publically downloadable workflows that have dataflows that can be represent...">$res</a>=mysqli_query($con, $predsql);
<a name="l00988"></a>00988         <span class="keywordflow">return</span> mysqli_result(<a class="code" href="generateDataflowRDF_8php.html#a49a8a4009b02e49717caa88b128affc5" title="An SQL result for all the publically downloadable workflows that have dataflows that can be represent...">$res</a>,0,<span class="stringliteral">&#39;ontology_uri&#39;</span>).<span class="stringliteral">&quot;/&quot;</span>.mysqli_result(<a class="code" href="generateDataflowRDF_8php.html#a49a8a4009b02e49717caa88b128affc5" title="An SQL result for all the publically downloadable workflows that have dataflows that can be represent...">$res</a>,0,<span class="stringliteral">&#39;predicate&#39;</span>);
<a name="l00989"></a>00989 }
<a name="l00990"></a>00990 
<a name="l01000"></a><a class="code" href="property_8inc_8php.html#a771d8e839a43cbe07aa8a1f45a98aba8">01000</a> function <a class="code" href="property_8inc_8php.html#a771d8e839a43cbe07aa8a1f45a98aba8" title="Generate RDF/XML entities for all predicates in a user-defined Ontology.">generatePredicatesRDF</a>($id){
<a name="l01001"></a>01001         global <a class="code" href="generateDataflowRDF_8php.html#a047170d6020a882807665812a27e2525" title="A string containing an SQL query to find all the publically downloadable workflows that have dataflow...">$sql</a>;
<a name="l01002"></a>01002         $predssql=$sql[<span class="stringliteral">&#39;Predicate&#39;</span>];
<a name="l01003"></a>01003         <span class="keywordflow">if</span> (!stripos(<span class="stringliteral">&#39;where&#39;</span>,$sql[<span class="stringliteral">&#39;Predicate&#39;</span>])) $predssql.=<span class="stringliteral">&quot; where &quot;</span>;
<a name="l01004"></a>01004         <span class="keywordflow">else</span> $predssql.=<span class="stringliteral">&quot; and &quot;</span>;
<a name="l01005"></a>01005         $predssql.=<span class="stringliteral">&quot;predicates.ontology_id=$id&quot;</span>;
<a name="l01006"></a>01006         <a class="code" href="generateDataflowRDF_8php.html#a49a8a4009b02e49717caa88b128affc5" title="An SQL result for all the publically downloadable workflows that have dataflows that can be represent...">$res</a>=mysqli_query($con, $predssql);
<a name="l01007"></a>01007         <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>=<span class="stringliteral">&quot;&quot;</span>;
<a name="l01008"></a>01008         <span class="keywordflow">for</span> (<a class="code" href="current__spec_8php.html#ab0ed46ece3f8d301125a0f2728d90d7b" title="$counter for the number of properties.">$p</a>=0; <a class="code" href="current__spec_8php.html#ab0ed46ece3f8d301125a0f2728d90d7b" title="$counter for the number of properties.">$p</a>&lt;mysqli_num_rows(<a class="code" href="generateDataflowRDF_8php.html#a49a8a4009b02e49717caa88b128affc5" title="An SQL result for all the publically downloadable workflows that have dataflows that can be represent...">$res</a>); <a class="code" href="current__spec_8php.html#ab0ed46ece3f8d301125a0f2728d90d7b" title="$counter for the number of properties.">$p</a>++){
<a name="l01009"></a>01009                 <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>.=<a class="code" href="rdf_8inc_8php.html#ae4fd0b2214091d22d01543ad067d399b" title="Generates RDF/XML for a particular entity.">generateEntityRDF</a>(mysqli_fetch_assoc(<a class="code" href="generateDataflowRDF_8php.html#a49a8a4009b02e49717caa88b128affc5" title="An SQL result for all the publically downloadable workflows that have dataflows that can be represent...">$res</a>),<span class="stringliteral">&quot;Predicate&quot;</span>);
<a name="l01010"></a>01010         }
<a name="l01011"></a>01011         <span class="keywordflow">return</span> <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>;
<a name="l01012"></a>01012 }
<a name="l01013"></a>01013 
<a name="l01023"></a><a class="code" href="property_8inc_8php.html#aaa2578078beb5be572bb100d8ea7eb6e">01023</a> function <a class="code" href="property_8inc_8php.html#aaa2578078beb5be572bb100d8ea7eb6e" title="Get static (i.e. the same for every user-generated Ontology) RDF/XML properties for user-generated On...">getStaticOntologyDetails</a>(<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>){
<a name="l01024"></a>01024         <span class="keywordflow">return</span> <span class="stringliteral">&quot;    &lt;dc:language rdf:datatype=\&quot;&amp;xsd;string\&quot;&gt;en&lt;/dc:language&gt;\n    &lt;dc:publisher rdf:resource=\&quot;http://www.myexperiment.org\&quot;/&gt;\n    &lt;dc:format rdf:datatype=\&quot;&amp;xsd;string\&quot;&gt;rdf/xml&lt;/dc:format&gt;\n&quot;</span>;
<a name="l01025"></a>01025 }
<a name="l01026"></a>01026 
<a name="l01039"></a><a class="code" href="property_8inc_8php.html#a78fbce020c006b3418ed71da505d249b">01039</a> function <a class="code" href="property_8inc_8php.html#a78fbce020c006b3418ed71da505d249b" title="Get ore:aggregates RDF/XML properties for all items that a specified entity (e.g. Experiment...">getOREAggregatedResources</a>(<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>, $type){
<a name="l01040"></a>01040         global <a class="code" href="generateDataflowRDF_8php.html#a047170d6020a882807665812a27e2525" title="A string containing an SQL query to find all the publically downloadable workflows that have dataflow...">$sql</a>, <a class="code" href="data_8inc_8php.html#ab536a0d95f590a75a3a4e3228224e5eb" title="A multi-dimensional associative array specifying all the myExperiment entity types a particular piece...">$entities</a>, <a class="code" href="data_8inc_8php.html#a77de31c759b8ff4ccaa90c0d27bf9d25" title="An associative array mapping entity types in the database to myExperiment entity types (as defined wi...">$db_entity_mappings</a>;
<a name="l01041"></a>01041         <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>=<span class="stringliteral">&quot;&quot;</span>;
<a name="l01042"></a>01042         <span class="keywordflow">if</span> (!empty($entities[$type][<span class="stringliteral">&#39;aggregates_resources&#39;</span>])) {
<a name="l01043"></a>01043                 <span class="keywordflow">if</span> (!isset(<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[<span class="stringliteral">&#39;version&#39;</span>])) <a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[<span class="stringliteral">&#39;version&#39;</span>] = null;
<a name="l01044"></a>01044                 $arsql=<a class="code" href="sql_8inc_8php.html#a00ddd0954f953e4c9506244a686c8b3b" title="Generates an SQL query to find the aggregated resources for a particular Experiment, Pack or PackSnapshot.">getAggregatedResourceSQL</a>($type,<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[<span class="stringliteral">&#39;id&#39;</span>],<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[<span class="stringliteral">&#39;version&#39;</span>]);
<a name="l01045"></a>01045                 <a class="code" href="generateDataflowRDF_8php.html#a49a8a4009b02e49717caa88b128affc5" title="An SQL result for all the publically downloadable workflows that have dataflows that can be represent...">$res</a>=mysqli_query($con, $arsql);
<a name="l01046"></a>01046                 <span class="keywordflow">for</span> ($i=0; $i&lt;mysqli_num_rows(<a class="code" href="generateDataflowRDF_8php.html#a49a8a4009b02e49717caa88b128affc5" title="An SQL result for all the publically downloadable workflows that have dataflows that can be represent...">$res</a>); $i++){
<a name="l01047"></a>01047                         $row=mysqli_fetch_assoc(<a class="code" href="generateDataflowRDF_8php.html#a49a8a4009b02e49717caa88b128affc5" title="An SQL result for all the publically downloadable workflows that have dataflows that can be represent...">$res</a>);
<a name="l01048"></a>01048                         $row[<span class="stringliteral">&#39;contributable_type&#39;</span>] = $db_entity_mappings[$row[<span class="stringliteral">&#39;contributable_type&#39;</span>]];
<a name="l01049"></a>01049                         <span class="keywordflow">if</span> (isset($row[<span class="stringliteral">&#39;runnable_id&#39;</span>])){
<a name="l01050"></a>01050                                 $row[<span class="stringliteral">&#39;contributable_type&#39;</span>]=<span class="stringliteral">&quot;Job&quot;</span>;
<a name="l01051"></a>01051                                 $row[<span class="stringliteral">&#39;contributable_id&#39;</span>]=$row[<span class="stringliteral">&#39;id&#39;</span>];
<a name="l01052"></a>01052                                 $row[<span class="stringliteral">&#39;entry_type&#39;</span>]=<span class="stringliteral">&quot;LocalPackEntry&quot;</span>;
<a name="l01053"></a>01053                         }
<a name="l01054"></a>01054                         <span class="keywordflow">if</span> ($row[<span class="stringliteral">&#39;entry_type&#39;</span>]==<span class="stringliteral">&quot;RemotePackEntry&quot;</span>) $fulluri=$row[<span class="stringliteral">&#39;uri&#39;</span>];
<a name="l01055"></a>01055                         <span class="keywordflow">else</span> $fulluri=<a class="code" href="property_8inc_8php.html#a5111c785fc992ce2d62ec8213ac3112b" title="Determine the URI for an entity from its type, ID and other fields retrieved from a database query...">getEntityURI</a>($row[<span class="stringliteral">&#39;contributable_type&#39;</span>], $row[<span class="stringliteral">&#39;contributable_id&#39;</span>], $row);
<a name="l01056"></a>01056                         <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>.=<span class="stringliteral">&quot;    &lt;ore:aggregates rdf:resource=\&quot;&quot;</span>.str_replace(<span class="stringliteral">&quot;&amp;&quot;</span>,<span class="stringliteral">&quot;&amp;amp;&quot;</span>,$fulluri).<span class="stringliteral">&quot;\&quot;/&gt;\n&quot;</span>;
<a name="l01057"></a>01057                 }
<a name="l01058"></a>01058                 <span class="keywordflow">if</span> ($type==<span class="stringliteral">&quot;Pack&quot;</span> || $type==<span class="stringliteral">&quot;PackSnapshot&quot;</span>){
<a name="l01059"></a>01059                         $prsql=$sql[<span class="stringliteral">&#39;RelationshipEntry&#39;</span>];
<a name="l01060"></a>01060                         <span class="keywordflow">if</span> (stripos($prsql,<span class="stringliteral">&#39;where&#39;</span>)&gt;0) $prsql.=<span class="stringliteral">&quot; and &quot;</span>;
<a name="l01061"></a>01061                         <span class="keywordflow">else</span> $prsql.=<span class="stringliteral">&quot; where &quot;</span>;
<a name="l01062"></a>01062                         $prsql.=<span class="stringliteral">&quot;context_id=$entity[id]&quot;</span>;
<a name="l01063"></a>01063                         <a class="code" href="generateDataflowRDF_8php.html#a49a8a4009b02e49717caa88b128affc5" title="An SQL result for all the publically downloadable workflows that have dataflows that can be represent...">$res</a>=mysqli_query($con, $prsql);
<a name="l01064"></a>01064                         <span class="keywordflow">for</span> ($i=0; $i&lt;mysqli_num_rows(<a class="code" href="generateDataflowRDF_8php.html#a49a8a4009b02e49717caa88b128affc5" title="An SQL result for all the publically downloadable workflows that have dataflows that can be represent...">$res</a>); $i++){
<a name="l01065"></a>01065                                 $row=mysqli_fetch_assoc(<a class="code" href="generateDataflowRDF_8php.html#a49a8a4009b02e49717caa88b128affc5" title="An SQL result for all the publically downloadable workflows that have dataflows that can be represent...">$res</a>);
<a name="l01066"></a>01066                                 $relurn=<a class="code" href="property_8inc_8php.html#adee3ea5a7211b9b9b433ff5d321339ae" title="Generate a version 5 (RFC4122) UUID to provide a URN for the specific Relationship. Using the URIs for the subject, predicate and object of the Relationship.">getRelationshipURN</a>(<a class="code" href="property_8inc_8php.html#a8c360395168871a91bdde4d0b20fa732" title="Generate an associative array containing the subject, predicate and object representing the Relations...">getRelationshipSPO</a>($row));
<a name="l01067"></a>01067                                 <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>.=<span class="stringliteral">&quot;    &lt;ore:aggregates rdf:resource=\&quot;$relurn\&quot;/&gt;\n&quot;</span>;
<a name="l01068"></a>01068                         }
<a name="l01069"></a>01069                 }
<a name="l01070"></a>01070         }
<a name="l01071"></a>01071         <span class="keywordflow">return</span> <a class="code" href="listGraphs_8php.html#aa108d9d91e700ac530401dd363b0723b" title="A string containing the complete SPARQL results XML from the graphs query.">$xml</a>;
<a name="l01072"></a>01072 }
<a name="l01073"></a>01073 
<a name="l01086"></a><a class="code" href="property_8inc_8php.html#a3d6a9780ff97233916b86f1a1323ab96">01086</a> function <a class="code" href="property_8inc_8php.html#a3d6a9780ff97233916b86f1a1323ab96" title="Get the URI for the RDF graph representation of a specific aggregating entity.">getOREDescribedBy</a>(<a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>,$type){
<a name="l01087"></a>01087         <span class="keywordflow">return</span> <a class="code" href="property_8inc_8php.html#a5111c785fc992ce2d62ec8213ac3112b" title="Determine the URI for an entity from its type, ID and other fields retrieved from a database query...">getEntityURI</a>($type, <a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>[<span class="stringliteral">&#39;id&#39;</span>], <a class="code" href="ontent_8php.html#a7ace0ad85fd80fca062f2bf7e166ee47" title="A string containing the full URI for the ontology entity that has been requested.">$entity</a>).<span class="stringliteral">&quot;.rdf&quot;</span>;
<a name="l01088"></a>01088 }
<a name="l01089"></a>01089 
<a name="l01099"></a><a class="code" href="property_8inc_8php.html#aa6222f17a520eedc8a16909a574828c2">01099</a> function <a class="code" href="property_8inc_8php.html#aa6222f17a520eedc8a16909a574828c2" title="Generate the RDF/XML properties for a specified access rights Policy entity.">getPolicy</a>($policy){
<a name="l01100"></a>01100         $policy_url=<a class="code" href="property_8inc_8php.html#a5111c785fc992ce2d62ec8213ac3112b" title="Determine the URI for an entity from its type, ID and other fields retrieved from a database query...">getEntityURI</a>(<span class="stringliteral">&quot;Policy&quot;</span>, $policy[<span class="stringliteral">&#39;policy_id&#39;</span>], $policy);
<a name="l01101"></a>01101         $policy_xml=<span class="stringliteral">&quot;&quot;</span>;
<a name="l01102"></a>01102         $perms=<a class="code" href="rdf_8inc_8php.html#a85cc684b4b268d3774c0d37c2c129ad9" title="Get the permissions associated with a specified Policy.">getPermissions</a>($policy[<span class="stringliteral">&#39;policy_id&#39;</span>]);
<a name="l01103"></a>01103         <span class="keywordflow">if</span> (!isset($policy[<span class="stringliteral">&#39;share_mode&#39;</span>])) $policy=<a class="code" href="rdf_8inc_8php.html#a4542f26f96fe3106d064da119bdb5d92" title="Get the share and update modes for the Policy of a specified Contribution.">addShareAndUpdateMode</a>($policy);
<a name="l01104"></a>01104         $policy_xml.=<a class="code" href="property_8inc_8php.html#a2d2ec45c81698759acd5400ec4fba7a9" title="Generate the contributor permissions RDF/XML for a specified Policy.">getContributorPermissions</a>($policy[<span class="stringliteral">&#39;contributor_type&#39;</span>],$policy[<span class="stringliteral">&#39;contributor_id&#39;</span>]);
<a name="l01105"></a>01105         $policy_xml.=<a class="code" href="property_8inc_8php.html#aee05aadc84e1effe68f8af7b38b18b2d" title="Generate RDF/XML for a Policy with a specific share mode.">getShareModeAccesses</a>($policy[<span class="stringliteral">&#39;share_mode&#39;</span>]);
<a name="l01106"></a>01106         $policy_xml.=<a class="code" href="property_8inc_8php.html#a8c49fd0f14753cd81c281edd46e14dfe" title="Generate RDF/XML for a Policy with a specific update mode. (Also depependent on the Policy&amp;#39;s shar...">getUpdateModeAccesses</a>($policy[<span class="stringliteral">&#39;update_mode&#39;</span>], $policy[<span class="stringliteral">&#39;share_mode&#39;</span>],$perms);
<a name="l01107"></a>01107         $policy_xml.=<a class="code" href="property_8inc_8php.html#af3d45e3bb51164383371f119ad16639d" title="Generate RDF/XML for explicitly defined permissions for a Policy.">getPermissionAccesses</a>($perms,$policy_url);
<a name="l01108"></a>01108         <span class="keywordflow">return</span> $policy_xml;
<a name="l01109"></a>01109 }
<a name="l01110"></a>01110 
<a name="l01123"></a><a class="code" href="property_8inc_8php.html#a2d2ec45c81698759acd5400ec4fba7a9">01123</a> function <a class="code" href="property_8inc_8php.html#a2d2ec45c81698759acd5400ec4fba7a9" title="Generate the contributor permissions RDF/XML for a specified Policy.">getContributorPermissions</a>($contrib_type,$contrib_id){
<a name="l01124"></a>01124         global <a class="code" href="defaultsettings_8inc_8php.html#af3977e6112188cd0722cdde838f04c9d" title="A string specifying the base URI for any myExperiment RDF entities that are generated. (E.g. http://www.myexperiment.org/).">$datauri</a>, <a class="code" href="data_8inc_8php.html#ab536a0d95f590a75a3a4e3228224e5eb" title="A multi-dimensional associative array specifying all the myExperiment entity types a particular piece...">$entities</a>, <a class="code" href="data_8inc_8php.html#a77de31c759b8ff4ccaa90c0d27bf9d25" title="An associative array mapping entity types in the database to myExperiment entity types (as defined wi...">$db_entity_mappings</a>;
<a name="l01125"></a>01125         $contrib_type=$db_entity_mappings[$contrib_type];
<a name="l01126"></a>01126         $contributor=$entities[$contrib_type][<span class="stringliteral">&#39;url_subpath&#39;</span>].<span class="stringliteral">&quot;/&quot;</span>.$contrib_id;
<a name="l01127"></a>01127         <span class="keywordflow">return</span> <span class="stringliteral">&quot;    &lt;snarm:has-access&gt;\n      &lt;snarm:RestrictedAccess&gt;\n        &lt;snarm:has-accesser rdf:resource=\&quot;&quot;</span>.$datauri.<span class="stringliteral">&quot;$contributor\&quot;/&gt;\n        &lt;snarm:has-access-type rdf:resource=\&quot;&amp;mespec;View\&quot;/&gt;\n      &lt;/snarm:RestrictedAccess&gt;\n    &lt;/snarm:has-access&gt;\n    &lt;snarm:has-access&gt;\n      &lt;snarm:RestrictedAccess&gt;\n        &lt;snarm:has-accesser rdf:resource=\&quot;&quot;</span>.$datauri.<span class="stringliteral">&quot;$contributor\&quot;/&gt;\n        &lt;snarm:has-access-type rdf:resource=\&quot;&amp;mespec;Download\&quot;/&gt;\n      &lt;/snarm:RestrictedAccess&gt;\n    &lt;/snarm:has-access&gt;\n    &lt;snarm:has-access&gt;\n      &lt;snarm:RestrictedAccess&gt;\n        &lt;snarm:has-accesser rdf:resource=\&quot;&quot;</span>.$datauri.<span class="stringliteral">&quot;$contributor\&quot;/&gt;\n        &lt;snarm:has-access-type rdf:resource=\&quot;&amp;mespec;Edit\&quot;/&gt;\n      &lt;/snarm:RestrictedAccess&gt;\n    &lt;/snarm:has-access&gt;\n&quot;</span>;
<a name="l01128"></a>01128 }
<a name="l01129"></a>01129 
<a name="l01139"></a><a class="code" href="property_8inc_8php.html#aee05aadc84e1effe68f8af7b38b18b2d">01139</a> function <a class="code" href="property_8inc_8php.html#aee05aadc84e1effe68f8af7b38b18b2d" title="Generate RDF/XML for a Policy with a specific share mode.">getShareModeAccesses</a>($sm){
<a name="l01140"></a>01140         <span class="keywordflow">switch</span> ($sm){
<a name="l01141"></a>01141                 <span class="keywordflow">case</span> 0:
<a name="l01142"></a>01142                         <span class="keywordflow">return</span> <span class="stringliteral">&quot;    &lt;snarm:has-access rdf:resource=\&quot;&amp;mespec;PublicView\&quot;/&gt;\n    &lt;snarm:has-access rdf:resource=\&quot;&amp;mespec;PublicDownload\&quot;/&gt;\n&quot;</span>;
<a name="l01143"></a>01143                 <span class="keywordflow">case</span> 1:
<a name="l01144"></a>01144                         <span class="keywordflow">return</span> <span class="stringliteral">&quot;    &lt;snarm:has-access rdf:resource=\&quot;&amp;mespec;PublicView\&quot;/&gt;\n    &lt;snarm:has-access rdf:resource=\&quot;&amp;mespec;FriendsDownload\&quot;/&gt;\n&quot;</span>;
<a name="l01145"></a>01145                 <span class="keywordflow">case</span> 2:
<a name="l01146"></a>01146                         <span class="keywordflow">return</span> <span class="stringliteral">&quot;    &lt;snarm:has-access rdf:resource=\&quot;&amp;mespec;PublicView\&quot;/&gt;\n&quot;</span>;
<a name="l01147"></a>01147                 <span class="keywordflow">case</span> 3:
<a name="l01148"></a>01148                         <span class="keywordflow">return</span> <span class="stringliteral">&quot;    &lt;snarm:has-access rdf:resource=\&quot;&amp;mespec;FriendsView\&quot;/&gt;\n    &lt;snarm:has-access rdf:resource=\&quot;&amp;mespec;FriendsDownload\&quot;/&gt;\n&quot;</span>;
<a name="l01149"></a>01149                 <span class="keywordflow">case</span> 4;
<a name="l01150"></a>01150                         <span class="keywordflow">return</span> <span class="stringliteral">&quot;    &lt;snarm:has-access rdf:resource=\&quot;&amp;mespec;FriendsView\&quot;/&gt;\n&quot;</span>;
<a name="l01151"></a>01151                 <span class="keywordflow">default</span>:
<a name="l01152"></a>01152                         <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
<a name="l01153"></a>01153         }
<a name="l01154"></a>01154         <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
<a name="l01155"></a>01155 }
<a name="l01156"></a>01156 
<a name="l01169"></a><a class="code" href="property_8inc_8php.html#a8c49fd0f14753cd81c281edd46e14dfe">01169</a> function <a class="code" href="property_8inc_8php.html#a8c49fd0f14753cd81c281edd46e14dfe" title="Generate RDF/XML for a Policy with a specific update mode. (Also depependent on the Policy&amp;#39;s shar...">getUpdateModeAccesses</a>($um,$sm){
<a name="l01170"></a>01170         <span class="keywordflow">switch</span> ($um){
<a name="l01171"></a>01171                 <span class="keywordflow">case</span> 0:
<a name="l01172"></a>01172                         <span class="keywordflow">if</span> ($sm==0 &amp;&amp; is_int($sm)) <span class="keywordflow">return</span> <span class="stringliteral">&quot;    &lt;snarm:has-access rdf:resource=\&quot;&amp;mespec;PublicEdit\&quot;/&gt;\n&quot;</span>;
<a name="l01173"></a>01173                         elseif ($sm==1 || $sm==3) <span class="keywordflow">return</span> <span class="stringliteral">&quot;    &lt;snarm:has-access rdf:resource=\&quot;&amp;mespec;FriendsEdit\&quot;/&gt;\n&quot;</span>;
<a name="l01174"></a>01174                 <span class="keywordflow">case</span> 1:
<a name="l01175"></a>01175                         <span class="keywordflow">return</span> <span class="stringliteral">&quot;    &lt;snarm:has-access rdf:resource=\&quot;&amp;mespec;FriendsEdit\&quot;/&gt;\n&quot;</span>;
<a name="l01176"></a>01176                 <span class="keywordflow">default</span>:
<a name="l01177"></a>01177                         <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
<a name="l01178"></a>01178                 }
<a name="l01179"></a>01179         <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
<a name="l01180"></a>01180 }
<a name="l01181"></a>01181 
<a name="l01191"></a><a class="code" href="property_8inc_8php.html#af3d45e3bb51164383371f119ad16639d">01191</a> function <a class="code" href="property_8inc_8php.html#af3d45e3bb51164383371f119ad16639d" title="Generate RDF/XML for explicitly defined permissions for a Policy.">getPermissionAccesses</a>($perms){
<a name="l01192"></a>01192         global <a class="code" href="defaultsettings_8inc_8php.html#af3977e6112188cd0722cdde838f04c9d" title="A string specifying the base URI for any myExperiment RDF entities that are generated. (E.g. http://www.myexperiment.org/).">$datauri</a>, <a class="code" href="data_8inc_8php.html#ab536a0d95f590a75a3a4e3228224e5eb" title="A multi-dimensional associative array specifying all the myExperiment entity types a particular piece...">$entities</a>, <a class="code" href="data_8inc_8php.html#a77de31c759b8ff4ccaa90c0d27bf9d25" title="An associative array mapping entity types in the database to myExperiment entity types (as defined wi...">$db_entity_mappings</a>;
<a name="l01193"></a>01193         $accesses=<span class="stringliteral">&quot;&quot;</span>;
<a name="l01194"></a>01194         $a=3;
<a name="l01195"></a>01195         <span class="keywordflow">for</span> (<a class="code" href="current__spec_8php.html#ab0ed46ece3f8d301125a0f2728d90d7b" title="$counter for the number of properties.">$p</a>=0; <a class="code" href="current__spec_8php.html#ab0ed46ece3f8d301125a0f2728d90d7b" title="$counter for the number of properties.">$p</a>&lt;<span class="keyword">sizeof</span>($perms); <a class="code" href="current__spec_8php.html#ab0ed46ece3f8d301125a0f2728d90d7b" title="$counter for the number of properties.">$p</a>++){
<a name="l01196"></a>01196                 $perms[<a class="code" href="current__spec_8php.html#ab0ed46ece3f8d301125a0f2728d90d7b" title="$counter for the number of properties.">$p</a>][<span class="stringliteral">&#39;contributor_type&#39;</span>] = $db_entity_mappings[$perms[<a class="code" href="current__spec_8php.html#ab0ed46ece3f8d301125a0f2728d90d7b" title="$counter for the number of properties.">$p</a>][<span class="stringliteral">&#39;contributor_type&#39;</span>]];
<a name="l01197"></a>01197                 $url_subpath = $entities[$perms[<a class="code" href="current__spec_8php.html#ab0ed46ece3f8d301125a0f2728d90d7b" title="$counter for the number of properties.">$p</a>][<span class="stringliteral">&#39;contributor_type&#39;</span>]][<span class="stringliteral">&#39;url_subpath&#39;</span>];
<a name="l01198"></a>01198                 <span class="keywordflow">if</span> ($perms[<a class="code" href="current__spec_8php.html#ab0ed46ece3f8d301125a0f2728d90d7b" title="$counter for the number of properties.">$p</a>][<span class="stringliteral">&#39;view&#39;</span>]){
<a name="l01199"></a>01199                         $a++;
<a name="l01200"></a>01200                         $accesses.=<span class="stringliteral">&quot;    &lt;snarm:has-access&gt;\n      &lt;snarm:RestrictedAccess&gt;\n        &lt;snarm:has-accesser rdf:resource=\&quot;&quot;</span>.$datauri.$url_subpath.<span class="stringliteral">&quot;/&quot;</span>.$perms[<a class="code" href="current__spec_8php.html#ab0ed46ece3f8d301125a0f2728d90d7b" title="$counter for the number of properties.">$p</a>][<span class="stringliteral">&#39;contributor_id&#39;</span>].<span class="stringliteral">&quot;\&quot;/&gt;\n        &lt;snarm:has-access-type rdf:resource=\&quot;&amp;mespec;View\&quot;/&gt;\n      &lt;/snarm:RestrictedAccess&gt;\n    &lt;/snarm:has-access&gt;\n&quot;</span>;
<a name="l01201"></a>01201                 }
<a name="l01202"></a>01202                 <span class="keywordflow">if</span> ($perms[$p][<span class="stringliteral">&#39;download&#39;</span>]){
<a name="l01203"></a>01203                         $a++;
<a name="l01204"></a>01204                         $accesses.=<span class="stringliteral">&quot;    &lt;snarm:has-access&gt;\n      &lt;snarm:RestrictedAccess&gt;\n        &lt;snarm:has-accesser rdf:resource=\&quot;&quot;</span>.$datauri.$url_subpath.<span class="stringliteral">&quot;/&quot;</span>.$perms[<a class="code" href="current__spec_8php.html#ab0ed46ece3f8d301125a0f2728d90d7b" title="$counter for the number of properties.">$p</a>][<span class="stringliteral">&#39;contributor_id&#39;</span>].<span class="stringliteral">&quot;\&quot;/&gt;\n        &lt;snarm:has-access-type rdf:resource=\&quot;&amp;mespec;Download\&quot;/&gt;\n      &lt;/snarm:RestrictedAccess&gt;\n    &lt;/snarm:has-access&gt;\n&quot;</span>;
<a name="l01205"></a>01205                 }
<a name="l01206"></a>01206                 <span class="keywordflow">if</span> ($perms[$p][<span class="stringliteral">&#39;edit&#39;</span>]){
<a name="l01207"></a>01207                         $a++;
<a name="l01208"></a>01208                         $accesses.=<span class="stringliteral">&quot;    &lt;snarm:has-access&gt;\n      &lt;snarm:RestrictedAccess&gt;\n        &lt;snarm:has-accesser rdf:resource=\&quot;&quot;</span>.$datauri.$url_subpath.<span class="stringliteral">&quot;/&quot;</span>.$perms[<a class="code" href="current__spec_8php.html#ab0ed46ece3f8d301125a0f2728d90d7b" title="$counter for the number of properties.">$p</a>][<span class="stringliteral">&#39;contributor_id&#39;</span>].<span class="stringliteral">&quot;\&quot;/&gt;\n        &lt;snarm:has-access-type rdf:resource=\&quot;&amp;mespec;Edit\&quot;/&gt;\n      &lt;/snarm:RestrictedAccess&gt;\n    &lt;/snarm:has-access&gt;\n&quot;</span>;
<a name="l01209"></a>01209                 }
<a name="l01210"></a>01210         }
<a name="l01211"></a>01211         <span class="keywordflow">return</span> $accesses;
<a name="l01212"></a>01212 }
<a name="l01213"></a>01213 
<a name="l01226"></a><a class="code" href="property_8inc_8php.html#a34d5ac43005ae90fa67a66bdeba45464">01226</a> function <a class="code" href="property_8inc_8php.html#a34d5ac43005ae90fa67a66bdeba45464" title="Generate RDF/XML for the Dataflow (and potentially nested Dataflows thereof) of a particular Workflow...">generateDataflows</a>($dataflows,$ent_uri){
<a name="l01227"></a>01227         $dtstr=array(<span class="stringliteral">&#39;dcterms:title&#39;</span>,<span class="stringliteral">&#39;dcterms:description&#39;</span>,<span class="stringliteral">&#39;dcterms:identifier&#39;</span>,<span class="stringliteral">&#39;mecomp:processor-type&#39;</span>,<span class="stringliteral">&#39;mecomp:processor-script&#39;</span>,<span class="stringliteral">&#39;mecomp:service-name&#39;</span>,<span class="stringliteral">&#39;mecomp:authority-name&#39;</span>,<span class="stringliteral">&#39;mecomp:service-category&#39;</span>,<span class="stringliteral">&#39;mecomp:example-value&#39;</span>);
<a name="l01228"></a>01228         $dturi=array(<span class="stringliteral">&#39;mecomp:processor-uri&#39;</span>);
<a name="l01229"></a>01229         $rdf=<span class="stringliteral">&quot;&quot;</span>;
<a name="l01230"></a>01230         $dfmap=array();
<a name="l01231"></a>01231         $components=<span class="stringliteral">&quot;&quot;</span>;
<a name="l01232"></a>01232         <span class="keywordflow">foreach</span>($dataflows as $dfuri =&gt; $dataflow){
<a name="l01233"></a>01233                 $rdf.=<span class="stringliteral">&quot;  &lt;mecomp:Dataflow rdf:about=\&quot;$dfuri\&quot;&gt;\n&quot;</span>;
<a name="l01234"></a>01234                 <span class="keywordflow">if</span> (isset($dataflow[<span class="stringliteral">&#39;id&#39;</span>])){
<a name="l01235"></a>01235                         <span class="keywordflow">if</span> (<span class="keyword">sizeof</span>($dfmap)==0) $dfmap=<a class="code" href="rdf_8inc_8php.html#a729e817cdb3d8bcdc654fd49a254d559" title="Take an array of Dataflows and map their internal IDs the their URIs.">generateDataflowMappings</a>($dataflows);
<a name="l01236"></a>01236                         $rdf.=<span class="stringliteral">&quot;    &lt;dcterms:identifier rdf:datatype=\&quot;&amp;xsd;string\&quot;&gt;$dataflow[id]&lt;/dcterms:identifier&gt;\n&quot;</span>;
<a name="l01237"></a>01237                         unset($dataflow[<span class="stringliteral">&#39;id&#39;</span>]);
<a name="l01238"></a>01238                 }
<a name="l01239"></a>01239                 <span class="keywordflow">foreach</span> ($dataflow as $cnum =&gt; $comp){
<a name="l01240"></a>01240                         $comptype=$comp[<span class="stringliteral">&#39;type&#39;</span>];
<a name="l01241"></a>01241                         $rdf.=<span class="stringliteral">&quot;    &lt;mecomp:has-component&gt;\n      &lt;mecomp:$comptype rdf:about=\&quot;&quot;</span>.$dfuri.<span class="stringliteral">&quot;/components/$cnum\&quot;&gt;\n&quot;</span>;
<a name="l01242"></a>01242                         <span class="keywordflow">foreach</span> ($comp[<span class="stringliteral">&#39;props&#39;</span>] as $prop){
<a name="l01243"></a>01243                                 <span class="keywordflow">if</span> (in_array($prop[<span class="stringliteral">&#39;type&#39;</span>],$dtstr) &amp;&amp; isset($prop[<span class="stringliteral">&#39;value&#39;</span>])){
<a name="l01244"></a>01244                                        $rdf.=<span class="stringliteral">&quot;        &lt;&quot;</span>.$prop[<span class="stringliteral">&#39;type&#39;</span>].<span class="stringliteral">&quot; rdf:datatype=\&quot;&amp;xsd;string\&quot;&gt;&quot;</span>.<a class="code" href="xml_8inc_8php.html#aa545f6c86d33695e2d647b8b16262ace" title="Sanitizes and string so that it render as a value within some XML markup.">convertToXMLEntities</a>($prop[<span class="stringliteral">&#39;value&#39;</span>]).<span class="stringliteral">&quot;&lt;/&quot;</span>.$prop[<span class="stringliteral">&#39;type&#39;</span>].<span class="stringliteral">&quot;&gt;\n&quot;</span>;
<a name="l01245"></a>01245                                 }
<a name="l01246"></a>01246                                 elseif (in_array($prop[<span class="stringliteral">&#39;type&#39;</span>],$dturi)){
<a name="l01247"></a>01247                                         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;value&#39;</span>])) $rdf.=<span class="stringliteral">&quot;        &lt;&quot;</span>.$prop[<span class="stringliteral">&#39;type&#39;</span>].<span class="stringliteral">&quot; rdf:resource=\&quot;&quot;</span>.<a class="code" href="xml_8inc_8php.html#aa545f6c86d33695e2d647b8b16262ace" title="Sanitizes and string so that it render as a value within some XML markup.">convertToXMLEntities</a>($prop[<span class="stringliteral">&#39;value&#39;</span>]).<span class="stringliteral">&quot;\&quot;/&gt;\n&quot;</span>;
<a name="l01248"></a>01248                                 }
<a name="l01249"></a>01249                                 elseif ($prop[<span class="stringliteral">&#39;type&#39;</span>]==<span class="stringliteral">&quot;mecomp:executes-dataflow&quot;</span>){
<a name="l01250"></a>01250                                         <span class="keywordflow">if</span> (substr($prop[<span class="stringliteral">&#39;value&#39;</span>],0,7)!=<span class="stringliteral">&quot;http://&quot;</span>) $prop[<span class="stringliteral">&#39;value&#39;</span>]=$dfmap[$prop[<span class="stringliteral">&#39;value&#39;</span>]];
<a name="l01251"></a>01251                                         $rdf.=<span class="stringliteral">&quot;        &lt;&quot;</span>.$prop[<span class="stringliteral">&#39;type&#39;</span>].<span class="stringliteral">&quot; rdf:resource=\&quot;$prop[value]\&quot;/&gt;\n&quot;</span>;
<a name="l01252"></a>01252                                 }
<a name="l01253"></a>01253                                 elseif (isset($prop[<span class="stringliteral">&#39;value&#39;</span>])) $rdf.=<span class="stringliteral">&quot;        &lt;&quot;</span>.$prop[<span class="stringliteral">&#39;type&#39;</span>].<span class="stringliteral">&quot; rdf:resource=\&quot;$dfuri/components/&quot;</span>.urlencode($prop[<span class="stringliteral">&#39;value&#39;</span>]).<span class="stringliteral">&quot;\&quot;/&gt;\n&quot;</span>;
<a name="l01254"></a>01254                         }
<a name="l01255"></a>01255                         $rdf.=<span class="stringliteral">&quot;        &lt;mecomp:belongs-to-workflow rdf:resource=\&quot;$ent_uri\&quot;/&gt;\n      &lt;/mecomp:$comptype&gt;\n    &lt;/mecomp:has-component&gt;\n&quot;</span>;
<a name="l01256"></a>01256                 }
<a name="l01257"></a>01257                 $rdf.=<span class="stringliteral">&quot;  &lt;/mecomp:Dataflow&gt;\n\n&quot;</span>;
<a name="l01258"></a>01258         }
<a name="l01259"></a>01259         <span class="keywordflow">return</span> $rdf;
<a name="l01260"></a>01260 }
<a name="l01261"></a>01261 
<a name="l01262"></a>01262 
<a name="l01263"></a>01263 ?&gt;
</pre></div></div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Tue Apr 23 2013 for MyExperiment RDF by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
